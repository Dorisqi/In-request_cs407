{"ast":null,"code":"function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { compose } from 'recompose';\nimport { withTheme } from 'styled-components';\nimport { defaultProps } from '../../default-props';\nimport { normalizeColor, parseMetricToNum } from '../../utils';\nimport { StyledDiagram } from './StyledDiagram';\n\nvar computeMidPoint = function computeMidPoint(fromPoint, toPoint) {\n  return [fromPoint[0] > toPoint[0] ? toPoint[0] + (fromPoint[0] - toPoint[0]) / 2 : fromPoint[0] + (toPoint[0] - fromPoint[0]) / 2, fromPoint[1] > toPoint[1] ? toPoint[1] + (fromPoint[1] - toPoint[1]) / 2 : fromPoint[1] + (toPoint[1] - fromPoint[1]) / 2];\n};\n\nvar COMMANDS = {\n  curved: function curved(fromPoint, toPoint, offset, anchor) {\n    var midPoint = computeMidPoint(fromPoint, toPoint);\n    var cmds = \"M \" + (fromPoint[0] + offset) + \",\" + (fromPoint[1] + offset) + \" \";\n\n    if (anchor === 'horizontal') {\n      cmds += \"Q \" + (midPoint[0] + offset) + \",\" + (fromPoint[1] + offset) + \" \" + (midPoint[0] + offset + \",\" + (midPoint[1] + offset) + \" \");\n    } else {\n      cmds += \"Q \" + (fromPoint[0] + offset) + \",\" + (midPoint[1] + offset) + \" \" + (midPoint[0] + offset + \",\" + (midPoint[1] + offset) + \" \");\n    }\n\n    cmds += \"T \" + (toPoint[0] + offset) + \",\" + (toPoint[1] + offset);\n    return cmds;\n  },\n  direct: function direct(fromPoint, toPoint, offset) {\n    return \"M \" + (fromPoint[0] + offset) + \",\" + (fromPoint[1] + offset) + \" \" + (\"L \" + (toPoint[0] + offset) + \",\" + (toPoint[1] + offset));\n  },\n  rectilinear: function rectilinear(fromPoint, toPoint, offset, anchor) {\n    var midPoint = computeMidPoint(fromPoint, toPoint);\n    var cmds = \"M \" + (fromPoint[0] + offset) + \",\" + (fromPoint[1] + offset) + \" \";\n\n    if (anchor === 'horizontal') {\n      cmds += \"L \" + (midPoint[0] + offset) + \",\" + (fromPoint[1] + offset) + \" \" + (\"L \" + (midPoint[0] + offset) + \",\" + (toPoint[1] + offset) + \" \");\n    } else {\n      cmds += \"L \" + (fromPoint[0] + offset) + \",\" + (midPoint[1] + offset) + \" \" + (\"L \" + (toPoint[0] + offset) + \",\" + (midPoint[1] + offset) + \" \");\n    }\n\n    cmds += \"L \" + (toPoint[0] + offset) + \",\" + (toPoint[1] + offset);\n    return cmds;\n  }\n};\n\nvar findTarget = function findTarget(target) {\n  if (typeof target === 'string') {\n    return document.getElementById(target);\n  }\n\n  return target;\n};\n\nvar Diagram = function Diagram(_ref) {\n  var connections = _ref.connections,\n      theme = _ref.theme,\n      rest = _objectWithoutPropertiesLoose(_ref, [\"connections\", \"theme\"]);\n\n  var _useState = useState({\n    width: 0,\n    height: 0\n  }),\n      dimensions = _useState[0],\n      setDimensions = _useState[1];\n\n  var _useState2 = useState(),\n      connectionPoints = _useState2[0],\n      setConnectionPoints = _useState2[1];\n\n  var svgRef = useRef();\n  useEffect(function () {\n    setConnectionPoints(undefined);\n  }, [connections]);\n  var onResize = useCallback(function () {\n    var svg = svgRef.current;\n\n    if (svg) {\n      var rect = svg.getBoundingClientRect();\n\n      if (rect.width !== dimensions.width || rect.height !== dimensions.height) {\n        setDimensions({\n          width: rect.width,\n          height: rect.height\n        });\n        setConnectionPoints(undefined);\n      }\n    }\n  }, [dimensions.width, dimensions.height]); // Ref that stores resize handler\n\n  var savedOnResize = useRef(); // Update resize ref value if onResize changes.\n  // This allows our effect below to always get latest handler\n\n  useEffect(function () {\n    savedOnResize.current = onResize;\n  }, [onResize]);\n  useEffect(function () {\n    var onResizeHandler = function onResizeHandler(event) {\n      return savedOnResize.current(event);\n    };\n\n    onResizeHandler();\n    window.addEventListener('resize', onResizeHandler);\n    return function () {\n      window.removeEventListener('resize', onResizeHandler);\n    };\n  }, []);\n  var placeConnections = useCallback(function () {\n    var containerRect = svgRef.current.getBoundingClientRect();\n    var updatedConnectionPoints = connections.map(function (_ref2) {\n      var anchor = _ref2.anchor,\n          fromTarget = _ref2.fromTarget,\n          toTarget = _ref2.toTarget;\n      var points;\n      var fromElement = findTarget(fromTarget);\n      var toElement = findTarget(toTarget);\n\n      if (!fromElement) {\n        console.warn(\"Diagram cannot find \" + fromTarget);\n      }\n\n      if (!toElement) {\n        console.warn(\"Diagram cannot find \" + toTarget);\n      }\n\n      if (fromElement && toElement) {\n        var fromRect = fromElement.getBoundingClientRect();\n        var toRect = toElement.getBoundingClientRect(); // There is no x and y when unit testing.\n\n        var fromPoint = [fromRect.left - containerRect.left || 0, fromRect.top - containerRect.top || 0];\n        var toPoint = [toRect.left - containerRect.left || 0, toRect.top - containerRect.top || 0];\n\n        if (anchor === 'vertical') {\n          fromPoint[0] += fromRect.width / 2;\n          toPoint[0] += toRect.width / 2;\n\n          if (fromRect.top < toRect.top) {\n            fromPoint[1] += fromRect.height;\n          } else {\n            toPoint[1] += toRect.height;\n          }\n        } else if (anchor === 'horizontal') {\n          fromPoint[1] += fromRect.height / 2;\n          toPoint[1] += toRect.height / 2;\n\n          if (fromRect.left < toRect.left) {\n            fromPoint[0] += fromRect.width;\n          } else {\n            toPoint[0] += toRect.width;\n          }\n        } else {\n          // center\n          fromPoint[0] += fromRect.width / 2;\n          fromPoint[1] += fromRect.height / 2;\n          toPoint[0] += toRect.width / 2;\n          toPoint[1] += toRect.height / 2;\n        }\n\n        points = [fromPoint, toPoint];\n      }\n\n      return points;\n    });\n    setConnectionPoints(updatedConnectionPoints);\n  }, [connections]);\n  useEffect(function () {\n    if (!connectionPoints) {\n      placeConnections();\n    }\n  }, [connectionPoints, placeConnections]);\n  var paths;\n\n  if (connectionPoints) {\n    paths = connections.map(function (_ref3, index) {\n      var anchor = _ref3.anchor,\n          color = _ref3.color,\n          offset = _ref3.offset,\n          round = _ref3.round,\n          thickness = _ref3.thickness,\n          type = _ref3.type,\n          connectionRest = _objectWithoutPropertiesLoose(_ref3, [\"anchor\", \"color\", \"offset\", \"round\", \"thickness\", \"type\"]);\n\n      var path;\n\n      var cleanedRest = _extends({}, connectionRest);\n\n      delete cleanedRest.fromTarget;\n      delete cleanedRest.toTarget;\n      var points = connectionPoints[index];\n\n      if (points) {\n        var offsetWidth = offset ? parseMetricToNum(theme.global.edgeSize[offset]) : 0;\n        var d = COMMANDS[type || 'curved'](points[0], points[1], offsetWidth, anchor);\n        var strokeWidth = thickness ? parseMetricToNum(theme.global.edgeSize[thickness] || thickness) : 1;\n        var colorName = color || theme.diagram.line && theme.diagram.line.color;\n\n        if (!colorName) {\n          var colors = Object.keys(theme.global.colors).filter(function (n) {\n            return n.match(/^graph-[0-9]$/);\n          });\n          colorName = colors[index % colors.length];\n        }\n\n        path = React.createElement(\"path\", _extends({\n          // eslint-disable-next-line react/no-array-index-key\n          key: index\n        }, cleanedRest, {\n          stroke: normalizeColor(colorName, theme),\n          strokeWidth: strokeWidth,\n          strokeLinecap: round ? 'round' : 'butt',\n          strokeLinejoin: round ? 'round' : 'miter',\n          fill: \"none\",\n          d: d\n        }));\n      }\n\n      return path;\n    });\n  }\n\n  return React.createElement(StyledDiagram, _extends({\n    ref: svgRef,\n    viewBox: \"0 0 \" + dimensions.width + \" \" + dimensions.height,\n    preserveAspectRatio: \"xMinYMin meet\"\n  }, rest), React.createElement(\"g\", null, paths));\n};\n\nDiagram.defaultProps = {\n  connections: []\n};\nObject.setPrototypeOf(Diagram.defaultProps, defaultProps);\nvar DiagramDoc;\n\nif (process.env.NODE_ENV !== 'production') {\n  // eslint-disable-next-line global-require\n  DiagramDoc = require('./doc').doc(Diagram);\n}\n\nvar DiagramWrapper = compose(withTheme)(DiagramDoc || Diagram);\nexport { DiagramWrapper as Diagram };","map":{"version":3,"sources":["/Users/qier/Documents/cs407/In-request_cs407/dev/Front-end/in-request/node_modules/grommet/es6/components/Diagram/Diagram.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","_objectWithoutPropertiesLoose","excluded","sourceKeys","keys","indexOf","React","useState","useEffect","useRef","useCallback","compose","withTheme","defaultProps","normalizeColor","parseMetricToNum","StyledDiagram","computeMidPoint","fromPoint","toPoint","COMMANDS","curved","offset","anchor","midPoint","cmds","direct","rectilinear","findTarget","document","getElementById","Diagram","_ref","connections","theme","rest","_useState","width","height","dimensions","setDimensions","_useState2","connectionPoints","setConnectionPoints","svgRef","undefined","onResize","svg","current","rect","getBoundingClientRect","savedOnResize","onResizeHandler","event","window","addEventListener","removeEventListener","placeConnections","containerRect","updatedConnectionPoints","map","_ref2","fromTarget","toTarget","points","fromElement","toElement","console","warn","fromRect","toRect","left","top","paths","_ref3","index","color","round","thickness","type","connectionRest","path","cleanedRest","offsetWidth","global","edgeSize","d","strokeWidth","colorName","diagram","line","colors","filter","n","match","createElement","stroke","strokeLinecap","strokeLinejoin","fill","ref","viewBox","preserveAspectRatio","setPrototypeOf","DiagramDoc","process","env","NODE_ENV","require","doc","DiagramWrapper"],"mappings":"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","sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { compose } from 'recompose';\nimport { withTheme } from 'styled-components';\nimport { defaultProps } from '../../default-props';\nimport { normalizeColor, parseMetricToNum } from '../../utils';\nimport { StyledDiagram } from './StyledDiagram';\n\nvar computeMidPoint = function computeMidPoint(fromPoint, toPoint) {\n  return [fromPoint[0] > toPoint[0] ? toPoint[0] + (fromPoint[0] - toPoint[0]) / 2 : fromPoint[0] + (toPoint[0] - fromPoint[0]) / 2, fromPoint[1] > toPoint[1] ? toPoint[1] + (fromPoint[1] - toPoint[1]) / 2 : fromPoint[1] + (toPoint[1] - fromPoint[1]) / 2];\n};\n\nvar COMMANDS = {\n  curved: function curved(fromPoint, toPoint, offset, anchor) {\n    var midPoint = computeMidPoint(fromPoint, toPoint);\n    var cmds = \"M \" + (fromPoint[0] + offset) + \",\" + (fromPoint[1] + offset) + \" \";\n\n    if (anchor === 'horizontal') {\n      cmds += \"Q \" + (midPoint[0] + offset) + \",\" + (fromPoint[1] + offset) + \" \" + (midPoint[0] + offset + \",\" + (midPoint[1] + offset) + \" \");\n    } else {\n      cmds += \"Q \" + (fromPoint[0] + offset) + \",\" + (midPoint[1] + offset) + \" \" + (midPoint[0] + offset + \",\" + (midPoint[1] + offset) + \" \");\n    }\n\n    cmds += \"T \" + (toPoint[0] + offset) + \",\" + (toPoint[1] + offset);\n    return cmds;\n  },\n  direct: function direct(fromPoint, toPoint, offset) {\n    return \"M \" + (fromPoint[0] + offset) + \",\" + (fromPoint[1] + offset) + \" \" + (\"L \" + (toPoint[0] + offset) + \",\" + (toPoint[1] + offset));\n  },\n  rectilinear: function rectilinear(fromPoint, toPoint, offset, anchor) {\n    var midPoint = computeMidPoint(fromPoint, toPoint);\n    var cmds = \"M \" + (fromPoint[0] + offset) + \",\" + (fromPoint[1] + offset) + \" \";\n\n    if (anchor === 'horizontal') {\n      cmds += \"L \" + (midPoint[0] + offset) + \",\" + (fromPoint[1] + offset) + \" \" + (\"L \" + (midPoint[0] + offset) + \",\" + (toPoint[1] + offset) + \" \");\n    } else {\n      cmds += \"L \" + (fromPoint[0] + offset) + \",\" + (midPoint[1] + offset) + \" \" + (\"L \" + (toPoint[0] + offset) + \",\" + (midPoint[1] + offset) + \" \");\n    }\n\n    cmds += \"L \" + (toPoint[0] + offset) + \",\" + (toPoint[1] + offset);\n    return cmds;\n  }\n};\n\nvar findTarget = function findTarget(target) {\n  if (typeof target === 'string') {\n    return document.getElementById(target);\n  }\n\n  return target;\n};\n\nvar Diagram = function Diagram(_ref) {\n  var connections = _ref.connections,\n      theme = _ref.theme,\n      rest = _objectWithoutPropertiesLoose(_ref, [\"connections\", \"theme\"]);\n\n  var _useState = useState({\n    width: 0,\n    height: 0\n  }),\n      dimensions = _useState[0],\n      setDimensions = _useState[1];\n\n  var _useState2 = useState(),\n      connectionPoints = _useState2[0],\n      setConnectionPoints = _useState2[1];\n\n  var svgRef = useRef();\n  useEffect(function () {\n    setConnectionPoints(undefined);\n  }, [connections]);\n  var onResize = useCallback(function () {\n    var svg = svgRef.current;\n\n    if (svg) {\n      var rect = svg.getBoundingClientRect();\n\n      if (rect.width !== dimensions.width || rect.height !== dimensions.height) {\n        setDimensions({\n          width: rect.width,\n          height: rect.height\n        });\n        setConnectionPoints(undefined);\n      }\n    }\n  }, [dimensions.width, dimensions.height]); // Ref that stores resize handler\n\n  var savedOnResize = useRef(); // Update resize ref value if onResize changes.\n  // This allows our effect below to always get latest handler\n\n  useEffect(function () {\n    savedOnResize.current = onResize;\n  }, [onResize]);\n  useEffect(function () {\n    var onResizeHandler = function onResizeHandler(event) {\n      return savedOnResize.current(event);\n    };\n\n    onResizeHandler();\n    window.addEventListener('resize', onResizeHandler);\n    return function () {\n      window.removeEventListener('resize', onResizeHandler);\n    };\n  }, []);\n  var placeConnections = useCallback(function () {\n    var containerRect = svgRef.current.getBoundingClientRect();\n    var updatedConnectionPoints = connections.map(function (_ref2) {\n      var anchor = _ref2.anchor,\n          fromTarget = _ref2.fromTarget,\n          toTarget = _ref2.toTarget;\n      var points;\n      var fromElement = findTarget(fromTarget);\n      var toElement = findTarget(toTarget);\n\n      if (!fromElement) {\n        console.warn(\"Diagram cannot find \" + fromTarget);\n      }\n\n      if (!toElement) {\n        console.warn(\"Diagram cannot find \" + toTarget);\n      }\n\n      if (fromElement && toElement) {\n        var fromRect = fromElement.getBoundingClientRect();\n        var toRect = toElement.getBoundingClientRect(); // There is no x and y when unit testing.\n\n        var fromPoint = [fromRect.left - containerRect.left || 0, fromRect.top - containerRect.top || 0];\n        var toPoint = [toRect.left - containerRect.left || 0, toRect.top - containerRect.top || 0];\n\n        if (anchor === 'vertical') {\n          fromPoint[0] += fromRect.width / 2;\n          toPoint[0] += toRect.width / 2;\n\n          if (fromRect.top < toRect.top) {\n            fromPoint[1] += fromRect.height;\n          } else {\n            toPoint[1] += toRect.height;\n          }\n        } else if (anchor === 'horizontal') {\n          fromPoint[1] += fromRect.height / 2;\n          toPoint[1] += toRect.height / 2;\n\n          if (fromRect.left < toRect.left) {\n            fromPoint[0] += fromRect.width;\n          } else {\n            toPoint[0] += toRect.width;\n          }\n        } else {\n          // center\n          fromPoint[0] += fromRect.width / 2;\n          fromPoint[1] += fromRect.height / 2;\n          toPoint[0] += toRect.width / 2;\n          toPoint[1] += toRect.height / 2;\n        }\n\n        points = [fromPoint, toPoint];\n      }\n\n      return points;\n    });\n    setConnectionPoints(updatedConnectionPoints);\n  }, [connections]);\n  useEffect(function () {\n    if (!connectionPoints) {\n      placeConnections();\n    }\n  }, [connectionPoints, placeConnections]);\n  var paths;\n\n  if (connectionPoints) {\n    paths = connections.map(function (_ref3, index) {\n      var anchor = _ref3.anchor,\n          color = _ref3.color,\n          offset = _ref3.offset,\n          round = _ref3.round,\n          thickness = _ref3.thickness,\n          type = _ref3.type,\n          connectionRest = _objectWithoutPropertiesLoose(_ref3, [\"anchor\", \"color\", \"offset\", \"round\", \"thickness\", \"type\"]);\n\n      var path;\n\n      var cleanedRest = _extends({}, connectionRest);\n\n      delete cleanedRest.fromTarget;\n      delete cleanedRest.toTarget;\n      var points = connectionPoints[index];\n\n      if (points) {\n        var offsetWidth = offset ? parseMetricToNum(theme.global.edgeSize[offset]) : 0;\n        var d = COMMANDS[type || 'curved'](points[0], points[1], offsetWidth, anchor);\n        var strokeWidth = thickness ? parseMetricToNum(theme.global.edgeSize[thickness] || thickness) : 1;\n        var colorName = color || theme.diagram.line && theme.diagram.line.color;\n\n        if (!colorName) {\n          var colors = Object.keys(theme.global.colors).filter(function (n) {\n            return n.match(/^graph-[0-9]$/);\n          });\n          colorName = colors[index % colors.length];\n        }\n\n        path = React.createElement(\"path\", _extends({\n          // eslint-disable-next-line react/no-array-index-key\n          key: index\n        }, cleanedRest, {\n          stroke: normalizeColor(colorName, theme),\n          strokeWidth: strokeWidth,\n          strokeLinecap: round ? 'round' : 'butt',\n          strokeLinejoin: round ? 'round' : 'miter',\n          fill: \"none\",\n          d: d\n        }));\n      }\n\n      return path;\n    });\n  }\n\n  return React.createElement(StyledDiagram, _extends({\n    ref: svgRef,\n    viewBox: \"0 0 \" + dimensions.width + \" \" + dimensions.height,\n    preserveAspectRatio: \"xMinYMin meet\"\n  }, rest), React.createElement(\"g\", null, paths));\n};\n\nDiagram.defaultProps = {\n  connections: []\n};\nObject.setPrototypeOf(Diagram.defaultProps, defaultProps);\nvar DiagramDoc;\n\nif (process.env.NODE_ENV !== 'production') {\n  // eslint-disable-next-line global-require\n  DiagramDoc = require('./doc').doc(Diagram);\n}\n\nvar DiagramWrapper = compose(withTheme)(DiagramDoc || Diagram);\nexport { DiagramWrapper as Diagram };"]},"metadata":{},"sourceType":"module"}