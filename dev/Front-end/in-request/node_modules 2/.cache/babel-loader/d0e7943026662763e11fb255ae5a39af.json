{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/web.dom-collections.iterator\");\n\nrequire(\"core-js/modules/web.immediate\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = exports.Channel = void 0;\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nvar generateRandomId = function generateRandomId() {\n  // generates a random 13 character string\n  return Math.random().toString(16).slice(2);\n};\n\nvar Channel =\n/*#__PURE__*/\nfunction () {\n  function Channel() {\n    var _this = this;\n\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        transport = _ref.transport,\n        _ref$async = _ref.async,\n        async = _ref$async === void 0 ? false : _ref$async;\n\n    _classCallCheck(this, Channel);\n\n    this.isAsync = void 0;\n    this.sender = generateRandomId();\n    this.events = {};\n    this.transport = void 0;\n    this.isAsync = async;\n\n    if (transport) {\n      this.transport = transport;\n      this.transport.setHandler(function (event) {\n        return _this.handleEvent(event);\n      });\n    }\n  }\n\n  _createClass(Channel, [{\n    key: \"addListener\",\n    value: function addListener(eventName, listener) {\n      this.events[eventName] = this.events[eventName] || [];\n      this.events[eventName].push(listener);\n    }\n  }, {\n    key: \"addPeerListener\",\n    value: function addPeerListener(eventName, listener) {\n      var peerListener = listener;\n      peerListener.ignorePeer = true;\n      this.addListener(eventName, peerListener);\n    }\n  }, {\n    key: \"emit\",\n    value: function emit(eventName) {\n      var _this2 = this;\n\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      var event = {\n        type: eventName,\n        args: args,\n        from: this.sender\n      };\n      var options = {};\n\n      if (args.length >= 1 && args[0] && args[0].options) {\n        options = args[0].options;\n      }\n\n      var handler = function handler() {\n        if (_this2.transport) {\n          _this2.transport.send(event, options);\n        }\n\n        _this2.handleEvent(event, true);\n      };\n\n      if (this.isAsync) {\n        // todo I'm not sure how to test this\n        setImmediate(handler);\n      } else {\n        handler();\n      }\n    }\n  }, {\n    key: \"eventNames\",\n    value: function eventNames() {\n      return Object.keys(this.events);\n    }\n  }, {\n    key: \"listenerCount\",\n    value: function listenerCount(eventName) {\n      var listeners = this.listeners(eventName);\n      return listeners ? listeners.length : 0;\n    }\n  }, {\n    key: \"listeners\",\n    value: function listeners(eventName) {\n      var listeners = this.events[eventName];\n      return listeners || undefined;\n    }\n  }, {\n    key: \"once\",\n    value: function once(eventName, listener) {\n      var onceListener = this.onceListener(eventName, listener);\n      this.addListener(eventName, onceListener);\n    }\n  }, {\n    key: \"removeAllListeners\",\n    value: function removeAllListeners(eventName) {\n      if (!eventName) {\n        this.events = {};\n      } else if (this.events[eventName]) {\n        delete this.events[eventName];\n      }\n    }\n  }, {\n    key: \"removeListener\",\n    value: function removeListener(eventName, listener) {\n      var listeners = this.listeners(eventName);\n\n      if (listeners) {\n        this.events[eventName] = listeners.filter(function (l) {\n          return l !== listener;\n        });\n      }\n    }\n  }, {\n    key: \"on\",\n    value: function on(eventName, listener) {\n      this.addListener(eventName, listener);\n    }\n  }, {\n    key: \"off\",\n    value: function off(eventName, listener) {\n      this.removeListener(eventName, listener);\n    }\n  }, {\n    key: \"handleEvent\",\n    value: function handleEvent(event) {\n      var isPeer = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var listeners = this.listeners(event.type);\n\n      if (listeners && (isPeer || event.from !== this.sender)) {\n        listeners.forEach(function (fn) {\n          return !(isPeer && fn.ignorePeer) && fn.apply(void 0, _toConsumableArray(event.args));\n        });\n      }\n    }\n  }, {\n    key: \"onceListener\",\n    value: function onceListener(eventName, listener) {\n      var _this3 = this;\n\n      var onceListener = function onceListener() {\n        _this3.removeListener(eventName, onceListener);\n\n        return listener.apply(void 0, arguments);\n      };\n\n      return onceListener;\n    }\n  }, {\n    key: \"hasTransport\",\n    get: function get() {\n      return !!this.transport;\n    }\n  }]);\n\n  return Channel;\n}();\n\nexports.Channel = Channel;\nvar _default = Channel;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["/Users/qier/Documents/cs407/In-request_cs407/dev/Front-end/in-request/node_modules/@storybook/channels/dist/index.js"],"names":["require","Object","defineProperty","exports","value","Channel","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","TypeError","iter","Symbol","iterator","prototype","toString","call","Array","from","isArray","i","arr2","length","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","key","_createClass","protoProps","staticProps","generateRandomId","Math","random","slice","_this","_ref","arguments","undefined","transport","_ref$async","async","isAsync","sender","events","setHandler","event","handleEvent","addListener","eventName","listener","push","addPeerListener","peerListener","ignorePeer","emit","_this2","_len","args","_key","type","options","handler","send","setImmediate","eventNames","keys","listenerCount","listeners","once","onceListener","removeAllListeners","removeListener","filter","l","on","off","isPeer","forEach","fn","apply","_this3","get","_default"],"mappings":"AAAA;;AAkCAA,OAAO,CAAC,8CAAD,CAAP;;AAEAA,OAAO,CAAC,+BAAD,CAAP;;AAEAC,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAC3CC,EAAAA,KAAK,EAAE;AADoC,CAA7C;AAGAD,OAAO,CAAC,SAAD,CAAP,GAAqBA,OAAO,CAACE,OAAR,GAAkB,KAAK,CAA5C;;AAEA,SAASC,kBAAT,CAA4BC,GAA5B,EAAiC;AAAE,SAAOC,kBAAkB,CAACD,GAAD,CAAlB,IAA2BE,gBAAgB,CAACF,GAAD,CAA3C,IAAoDG,kBAAkB,EAA7E;AAAkF;;AAErH,SAASA,kBAAT,GAA8B;AAAE,QAAM,IAAIC,SAAJ,CAAc,iDAAd,CAAN;AAAyE;;AAEzG,SAASF,gBAAT,CAA0BG,IAA1B,EAAgC;AAAE,MAAIC,MAAM,CAACC,QAAP,IAAmBb,MAAM,CAACW,IAAD,CAAzB,IAAmCX,MAAM,CAACc,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,CAA+BL,IAA/B,MAAyC,oBAAhF,EAAsG,OAAOM,KAAK,CAACC,IAAN,CAAWP,IAAX,CAAP;AAA0B;;AAElK,SAASJ,kBAAT,CAA4BD,GAA5B,EAAiC;AAAE,MAAIW,KAAK,CAACE,OAAN,CAAcb,GAAd,CAAJ,EAAwB;AAAE,SAAK,IAAIc,CAAC,GAAG,CAAR,EAAWC,IAAI,GAAG,IAAIJ,KAAJ,CAAUX,GAAG,CAACgB,MAAd,CAAvB,EAA8CF,CAAC,GAAGd,GAAG,CAACgB,MAAtD,EAA8DF,CAAC,EAA/D,EAAmE;AAAEC,MAAAA,IAAI,CAACD,CAAD,CAAJ,GAAUd,GAAG,CAACc,CAAD,CAAb;AAAmB;;AAAC,WAAOC,IAAP;AAAc;AAAE;;AAEtK,SAASE,eAAT,CAAyBC,QAAzB,EAAmCC,WAAnC,EAAgD;AAAE,MAAI,EAAED,QAAQ,YAAYC,WAAtB,CAAJ,EAAwC;AAAE,UAAM,IAAIf,SAAJ,CAAc,mCAAd,CAAN;AAA2D;AAAE;;AAEzJ,SAASgB,iBAAT,CAA2BC,MAA3B,EAAmCC,KAAnC,EAA0C;AAAE,OAAK,IAAIR,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGQ,KAAK,CAACN,MAA1B,EAAkCF,CAAC,EAAnC,EAAuC;AAAE,QAAIS,UAAU,GAAGD,KAAK,CAACR,CAAD,CAAtB;AAA2BS,IAAAA,UAAU,CAACC,UAAX,GAAwBD,UAAU,CAACC,UAAX,IAAyB,KAAjD;AAAwDD,IAAAA,UAAU,CAACE,YAAX,GAA0B,IAA1B;AAAgC,QAAI,WAAWF,UAAf,EAA2BA,UAAU,CAACG,QAAX,GAAsB,IAAtB;AAA4BhC,IAAAA,MAAM,CAACC,cAAP,CAAsB0B,MAAtB,EAA8BE,UAAU,CAACI,GAAzC,EAA8CJ,UAA9C;AAA4D;AAAE;;AAE7T,SAASK,YAAT,CAAsBT,WAAtB,EAAmCU,UAAnC,EAA+CC,WAA/C,EAA4D;AAAE,MAAID,UAAJ,EAAgBT,iBAAiB,CAACD,WAAW,CAACX,SAAb,EAAwBqB,UAAxB,CAAjB;AAAsD,MAAIC,WAAJ,EAAiBV,iBAAiB,CAACD,WAAD,EAAcW,WAAd,CAAjB;AAA6C,SAAOX,WAAP;AAAqB;;AAEvN,IAAIY,gBAAgB,GAAG,SAASA,gBAAT,GAA4B;AACjD;AACA,SAAOC,IAAI,CAACC,MAAL,GAAcxB,QAAd,CAAuB,EAAvB,EAA2ByB,KAA3B,CAAiC,CAAjC,CAAP;AACD,CAHD;;AAKA,IAAIpC,OAAO;AACX;AACA,YAAY;AACV,WAASA,OAAT,GAAmB;AACjB,QAAIqC,KAAK,GAAG,IAAZ;;AAEA,QAAIC,IAAI,GAAGC,SAAS,CAACrB,MAAV,GAAmB,CAAnB,IAAwBqB,SAAS,CAAC,CAAD,CAAT,KAAiBC,SAAzC,GAAqDD,SAAS,CAAC,CAAD,CAA9D,GAAoE,EAA/E;AAAA,QACIE,SAAS,GAAGH,IAAI,CAACG,SADrB;AAAA,QAEIC,UAAU,GAAGJ,IAAI,CAACK,KAFtB;AAAA,QAGIA,KAAK,GAAGD,UAAU,KAAK,KAAK,CAApB,GAAwB,KAAxB,GAAgCA,UAH5C;;AAKAvB,IAAAA,eAAe,CAAC,IAAD,EAAOnB,OAAP,CAAf;;AAEA,SAAK4C,OAAL,GAAe,KAAK,CAApB;AACA,SAAKC,MAAL,GAAcZ,gBAAgB,EAA9B;AACA,SAAKa,MAAL,GAAc,EAAd;AACA,SAAKL,SAAL,GAAiB,KAAK,CAAtB;AACA,SAAKG,OAAL,GAAeD,KAAf;;AAEA,QAAIF,SAAJ,EAAe;AACb,WAAKA,SAAL,GAAiBA,SAAjB;AACA,WAAKA,SAAL,CAAeM,UAAf,CAA0B,UAAUC,KAAV,EAAiB;AACzC,eAAOX,KAAK,CAACY,WAAN,CAAkBD,KAAlB,CAAP;AACD,OAFD;AAGD;AACF;;AAEDlB,EAAAA,YAAY,CAAC9B,OAAD,EAAU,CAAC;AACrB6B,IAAAA,GAAG,EAAE,aADgB;AAErB9B,IAAAA,KAAK,EAAE,SAASmD,WAAT,CAAqBC,SAArB,EAAgCC,QAAhC,EAA0C;AAC/C,WAAKN,MAAL,CAAYK,SAAZ,IAAyB,KAAKL,MAAL,CAAYK,SAAZ,KAA0B,EAAnD;AACA,WAAKL,MAAL,CAAYK,SAAZ,EAAuBE,IAAvB,CAA4BD,QAA5B;AACD;AALoB,GAAD,EAMnB;AACDvB,IAAAA,GAAG,EAAE,iBADJ;AAED9B,IAAAA,KAAK,EAAE,SAASuD,eAAT,CAAyBH,SAAzB,EAAoCC,QAApC,EAA8C;AACnD,UAAIG,YAAY,GAAGH,QAAnB;AACAG,MAAAA,YAAY,CAACC,UAAb,GAA0B,IAA1B;AACA,WAAKN,WAAL,CAAiBC,SAAjB,EAA4BI,YAA5B;AACD;AANA,GANmB,EAanB;AACD1B,IAAAA,GAAG,EAAE,MADJ;AAED9B,IAAAA,KAAK,EAAE,SAAS0D,IAAT,CAAcN,SAAd,EAAyB;AAC9B,UAAIO,MAAM,GAAG,IAAb;;AAEA,WAAK,IAAIC,IAAI,GAAGpB,SAAS,CAACrB,MAArB,EAA6B0C,IAAI,GAAG,IAAI/C,KAAJ,CAAU8C,IAAI,GAAG,CAAP,GAAWA,IAAI,GAAG,CAAlB,GAAsB,CAAhC,CAApC,EAAwEE,IAAI,GAAG,CAApF,EAAuFA,IAAI,GAAGF,IAA9F,EAAoGE,IAAI,EAAxG,EAA4G;AAC1GD,QAAAA,IAAI,CAACC,IAAI,GAAG,CAAR,CAAJ,GAAiBtB,SAAS,CAACsB,IAAD,CAA1B;AACD;;AAED,UAAIb,KAAK,GAAG;AACVc,QAAAA,IAAI,EAAEX,SADI;AAEVS,QAAAA,IAAI,EAAEA,IAFI;AAGV9C,QAAAA,IAAI,EAAE,KAAK+B;AAHD,OAAZ;AAKA,UAAIkB,OAAO,GAAG,EAAd;;AAEA,UAAIH,IAAI,CAAC1C,MAAL,IAAe,CAAf,IAAoB0C,IAAI,CAAC,CAAD,CAAxB,IAA+BA,IAAI,CAAC,CAAD,CAAJ,CAAQG,OAA3C,EAAoD;AAClDA,QAAAA,OAAO,GAAGH,IAAI,CAAC,CAAD,CAAJ,CAAQG,OAAlB;AACD;;AAED,UAAIC,OAAO,GAAG,SAASA,OAAT,GAAmB;AAC/B,YAAIN,MAAM,CAACjB,SAAX,EAAsB;AACpBiB,UAAAA,MAAM,CAACjB,SAAP,CAAiBwB,IAAjB,CAAsBjB,KAAtB,EAA6Be,OAA7B;AACD;;AAEDL,QAAAA,MAAM,CAACT,WAAP,CAAmBD,KAAnB,EAA0B,IAA1B;AACD,OAND;;AAQA,UAAI,KAAKJ,OAAT,EAAkB;AAChB;AACAsB,QAAAA,YAAY,CAACF,OAAD,CAAZ;AACD,OAHD,MAGO;AACLA,QAAAA,OAAO;AACR;AACF;AAlCA,GAbmB,EAgDnB;AACDnC,IAAAA,GAAG,EAAE,YADJ;AAED9B,IAAAA,KAAK,EAAE,SAASoE,UAAT,GAAsB;AAC3B,aAAOvE,MAAM,CAACwE,IAAP,CAAY,KAAKtB,MAAjB,CAAP;AACD;AAJA,GAhDmB,EAqDnB;AACDjB,IAAAA,GAAG,EAAE,eADJ;AAED9B,IAAAA,KAAK,EAAE,SAASsE,aAAT,CAAuBlB,SAAvB,EAAkC;AACvC,UAAImB,SAAS,GAAG,KAAKA,SAAL,CAAenB,SAAf,CAAhB;AACA,aAAOmB,SAAS,GAAGA,SAAS,CAACpD,MAAb,GAAsB,CAAtC;AACD;AALA,GArDmB,EA2DnB;AACDW,IAAAA,GAAG,EAAE,WADJ;AAED9B,IAAAA,KAAK,EAAE,SAASuE,SAAT,CAAmBnB,SAAnB,EAA8B;AACnC,UAAImB,SAAS,GAAG,KAAKxB,MAAL,CAAYK,SAAZ,CAAhB;AACA,aAAOmB,SAAS,IAAI9B,SAApB;AACD;AALA,GA3DmB,EAiEnB;AACDX,IAAAA,GAAG,EAAE,MADJ;AAED9B,IAAAA,KAAK,EAAE,SAASwE,IAAT,CAAcpB,SAAd,EAAyBC,QAAzB,EAAmC;AACxC,UAAIoB,YAAY,GAAG,KAAKA,YAAL,CAAkBrB,SAAlB,EAA6BC,QAA7B,CAAnB;AACA,WAAKF,WAAL,CAAiBC,SAAjB,EAA4BqB,YAA5B;AACD;AALA,GAjEmB,EAuEnB;AACD3C,IAAAA,GAAG,EAAE,oBADJ;AAED9B,IAAAA,KAAK,EAAE,SAAS0E,kBAAT,CAA4BtB,SAA5B,EAAuC;AAC5C,UAAI,CAACA,SAAL,EAAgB;AACd,aAAKL,MAAL,GAAc,EAAd;AACD,OAFD,MAEO,IAAI,KAAKA,MAAL,CAAYK,SAAZ,CAAJ,EAA4B;AACjC,eAAO,KAAKL,MAAL,CAAYK,SAAZ,CAAP;AACD;AACF;AARA,GAvEmB,EAgFnB;AACDtB,IAAAA,GAAG,EAAE,gBADJ;AAED9B,IAAAA,KAAK,EAAE,SAAS2E,cAAT,CAAwBvB,SAAxB,EAAmCC,QAAnC,EAA6C;AAClD,UAAIkB,SAAS,GAAG,KAAKA,SAAL,CAAenB,SAAf,CAAhB;;AAEA,UAAImB,SAAJ,EAAe;AACb,aAAKxB,MAAL,CAAYK,SAAZ,IAAyBmB,SAAS,CAACK,MAAV,CAAiB,UAAUC,CAAV,EAAa;AACrD,iBAAOA,CAAC,KAAKxB,QAAb;AACD,SAFwB,CAAzB;AAGD;AACF;AAVA,GAhFmB,EA2FnB;AACDvB,IAAAA,GAAG,EAAE,IADJ;AAED9B,IAAAA,KAAK,EAAE,SAAS8E,EAAT,CAAY1B,SAAZ,EAAuBC,QAAvB,EAAiC;AACtC,WAAKF,WAAL,CAAiBC,SAAjB,EAA4BC,QAA5B;AACD;AAJA,GA3FmB,EAgGnB;AACDvB,IAAAA,GAAG,EAAE,KADJ;AAED9B,IAAAA,KAAK,EAAE,SAAS+E,GAAT,CAAa3B,SAAb,EAAwBC,QAAxB,EAAkC;AACvC,WAAKsB,cAAL,CAAoBvB,SAApB,EAA+BC,QAA/B;AACD;AAJA,GAhGmB,EAqGnB;AACDvB,IAAAA,GAAG,EAAE,aADJ;AAED9B,IAAAA,KAAK,EAAE,SAASkD,WAAT,CAAqBD,KAArB,EAA4B;AACjC,UAAI+B,MAAM,GAAGxC,SAAS,CAACrB,MAAV,GAAmB,CAAnB,IAAwBqB,SAAS,CAAC,CAAD,CAAT,KAAiBC,SAAzC,GAAqDD,SAAS,CAAC,CAAD,CAA9D,GAAoE,KAAjF;AACA,UAAI+B,SAAS,GAAG,KAAKA,SAAL,CAAetB,KAAK,CAACc,IAArB,CAAhB;;AAEA,UAAIQ,SAAS,KAAKS,MAAM,IAAI/B,KAAK,CAAClC,IAAN,KAAe,KAAK+B,MAAnC,CAAb,EAAyD;AACvDyB,QAAAA,SAAS,CAACU,OAAV,CAAkB,UAAUC,EAAV,EAAc;AAC9B,iBAAO,EAAEF,MAAM,IAAIE,EAAE,CAACzB,UAAf,KAA8ByB,EAAE,CAACC,KAAH,CAAS,KAAK,CAAd,EAAiBjF,kBAAkB,CAAC+C,KAAK,CAACY,IAAP,CAAnC,CAArC;AACD,SAFD;AAGD;AACF;AAXA,GArGmB,EAiHnB;AACD/B,IAAAA,GAAG,EAAE,cADJ;AAED9B,IAAAA,KAAK,EAAE,SAASyE,YAAT,CAAsBrB,SAAtB,EAAiCC,QAAjC,EAA2C;AAChD,UAAI+B,MAAM,GAAG,IAAb;;AAEA,UAAIX,YAAY,GAAG,SAASA,YAAT,GAAwB;AACzCW,QAAAA,MAAM,CAACT,cAAP,CAAsBvB,SAAtB,EAAiCqB,YAAjC;;AAEA,eAAOpB,QAAQ,CAAC8B,KAAT,CAAe,KAAK,CAApB,EAAuB3C,SAAvB,CAAP;AACD,OAJD;;AAMA,aAAOiC,YAAP;AACD;AAZA,GAjHmB,EA8HnB;AACD3C,IAAAA,GAAG,EAAE,cADJ;AAEDuD,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAO,CAAC,CAAC,KAAK3C,SAAd;AACD;AAJA,GA9HmB,CAAV,CAAZ;;AAqIA,SAAOzC,OAAP;AACD,CA/JD,EAFA;;AAmKAF,OAAO,CAACE,OAAR,GAAkBA,OAAlB;AACA,IAAIqF,QAAQ,GAAGrF,OAAf;AACAF,OAAO,CAAC,SAAD,CAAP,GAAqBuF,QAArB","sourcesContent":["\"use strict\";\n\nrequire(\"core-js/modules/es.symbol\");\n\nrequire(\"core-js/modules/es.symbol.description\");\n\nrequire(\"core-js/modules/es.symbol.iterator\");\n\nrequire(\"core-js/modules/es.array.filter\");\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.array.from\");\n\nrequire(\"core-js/modules/es.array.is-array\");\n\nrequire(\"core-js/modules/es.array.iterator\");\n\nrequire(\"core-js/modules/es.array.slice\");\n\nrequire(\"core-js/modules/es.date.to-string\");\n\nrequire(\"core-js/modules/es.object.define-property\");\n\nrequire(\"core-js/modules/es.object.keys\");\n\nrequire(\"core-js/modules/es.object.to-string\");\n\nrequire(\"core-js/modules/es.regexp.to-string\");\n\nrequire(\"core-js/modules/es.string.iterator\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator\");\n\nrequire(\"core-js/modules/web.immediate\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = exports.Channel = void 0;\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar generateRandomId = function generateRandomId() {\n  // generates a random 13 character string\n  return Math.random().toString(16).slice(2);\n};\n\nvar Channel =\n/*#__PURE__*/\nfunction () {\n  function Channel() {\n    var _this = this;\n\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        transport = _ref.transport,\n        _ref$async = _ref.async,\n        async = _ref$async === void 0 ? false : _ref$async;\n\n    _classCallCheck(this, Channel);\n\n    this.isAsync = void 0;\n    this.sender = generateRandomId();\n    this.events = {};\n    this.transport = void 0;\n    this.isAsync = async;\n\n    if (transport) {\n      this.transport = transport;\n      this.transport.setHandler(function (event) {\n        return _this.handleEvent(event);\n      });\n    }\n  }\n\n  _createClass(Channel, [{\n    key: \"addListener\",\n    value: function addListener(eventName, listener) {\n      this.events[eventName] = this.events[eventName] || [];\n      this.events[eventName].push(listener);\n    }\n  }, {\n    key: \"addPeerListener\",\n    value: function addPeerListener(eventName, listener) {\n      var peerListener = listener;\n      peerListener.ignorePeer = true;\n      this.addListener(eventName, peerListener);\n    }\n  }, {\n    key: \"emit\",\n    value: function emit(eventName) {\n      var _this2 = this;\n\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      var event = {\n        type: eventName,\n        args: args,\n        from: this.sender\n      };\n      var options = {};\n\n      if (args.length >= 1 && args[0] && args[0].options) {\n        options = args[0].options;\n      }\n\n      var handler = function handler() {\n        if (_this2.transport) {\n          _this2.transport.send(event, options);\n        }\n\n        _this2.handleEvent(event, true);\n      };\n\n      if (this.isAsync) {\n        // todo I'm not sure how to test this\n        setImmediate(handler);\n      } else {\n        handler();\n      }\n    }\n  }, {\n    key: \"eventNames\",\n    value: function eventNames() {\n      return Object.keys(this.events);\n    }\n  }, {\n    key: \"listenerCount\",\n    value: function listenerCount(eventName) {\n      var listeners = this.listeners(eventName);\n      return listeners ? listeners.length : 0;\n    }\n  }, {\n    key: \"listeners\",\n    value: function listeners(eventName) {\n      var listeners = this.events[eventName];\n      return listeners || undefined;\n    }\n  }, {\n    key: \"once\",\n    value: function once(eventName, listener) {\n      var onceListener = this.onceListener(eventName, listener);\n      this.addListener(eventName, onceListener);\n    }\n  }, {\n    key: \"removeAllListeners\",\n    value: function removeAllListeners(eventName) {\n      if (!eventName) {\n        this.events = {};\n      } else if (this.events[eventName]) {\n        delete this.events[eventName];\n      }\n    }\n  }, {\n    key: \"removeListener\",\n    value: function removeListener(eventName, listener) {\n      var listeners = this.listeners(eventName);\n\n      if (listeners) {\n        this.events[eventName] = listeners.filter(function (l) {\n          return l !== listener;\n        });\n      }\n    }\n  }, {\n    key: \"on\",\n    value: function on(eventName, listener) {\n      this.addListener(eventName, listener);\n    }\n  }, {\n    key: \"off\",\n    value: function off(eventName, listener) {\n      this.removeListener(eventName, listener);\n    }\n  }, {\n    key: \"handleEvent\",\n    value: function handleEvent(event) {\n      var isPeer = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var listeners = this.listeners(event.type);\n\n      if (listeners && (isPeer || event.from !== this.sender)) {\n        listeners.forEach(function (fn) {\n          return !(isPeer && fn.ignorePeer) && fn.apply(void 0, _toConsumableArray(event.args));\n        });\n      }\n    }\n  }, {\n    key: \"onceListener\",\n    value: function onceListener(eventName, listener) {\n      var _this3 = this;\n\n      var onceListener = function onceListener() {\n        _this3.removeListener(eventName, onceListener);\n\n        return listener.apply(void 0, arguments);\n      };\n\n      return onceListener;\n    }\n  }, {\n    key: \"hasTransport\",\n    get: function get() {\n      return !!this.transport;\n    }\n  }]);\n\n  return Channel;\n}();\n\nexports.Channel = Channel;\nvar _default = Channel;\nexports[\"default\"] = _default;"]},"metadata":{},"sourceType":"script"}