{"ast":null,"code":"function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nimport React, { createRef, Component } from 'react';\nimport styled, { withTheme } from 'styled-components';\nimport { debounce, debounceDelay, isNodeAfterScroll, isNodeBeforeScroll, selectedStyle, setFocusWithoutScroll } from '../../utils';\nimport { defaultProps } from '../../default-props';\nimport { Box } from '../Box';\nimport { InfiniteScroll } from '../InfiniteScroll';\nimport { Keyboard } from '../Keyboard';\nimport { Text } from '../Text';\nimport { TextInput } from '../TextInput';\nimport { SelectOption } from './SelectOption';\nimport { StyledContainer } from './StyledSelect'; // position relative is so scroll can be managed correctly\n\nvar OptionsBox = styled(Box).withConfig({\n  displayName: \"SelectContainer__OptionsBox\",\n  componentId: \"sc-1wi0ul8-0\"\n})([\"position:relative;scroll-behavior:smooth;\"]);\nvar OptionBox = styled(Box).withConfig({\n  displayName: \"SelectContainer__OptionBox\",\n  componentId: \"sc-1wi0ul8-1\"\n})([\"\", \"\"], function (props) {\n  return props.selected && selectedStyle;\n});\n\nvar SelectContainer =\n/*#__PURE__*/\nfunction (_Component) {\n  _inheritsLoose(SelectContainer, _Component);\n\n  function SelectContainer(props) {\n    var _this;\n\n    _this = _Component.call(this, props) || this;\n\n    _defineProperty(_assertThisInitialized(_this), \"optionRefs\", {});\n\n    _defineProperty(_assertThisInitialized(_this), \"searchRef\", createRef());\n\n    _defineProperty(_assertThisInitialized(_this), \"optionsRef\", createRef());\n\n    _defineProperty(_assertThisInitialized(_this), \"onSearchChange\", function (event) {\n      _this.setState({\n        search: event.target.value,\n        activeIndex: -1\n      }, function () {\n        var search = _this.state.search;\n\n        _this.onSearch(search);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSearch\", debounce(function (search) {\n      var onSearch = _this.props.onSearch;\n      onSearch(search);\n    }, debounceDelay(_this.props)));\n\n    _defineProperty(_assertThisInitialized(_this), \"selectOption\", function (option) {\n      return function () {\n        var _this$props = _this.props,\n            multiple = _this$props.multiple,\n            onChange = _this$props.onChange,\n            value = _this$props.value,\n            selected = _this$props.selected;\n        var initialOptions = _this.state.initialOptions;\n\n        if (onChange) {\n          var nextValue = Array.isArray(value) ? value.slice() : []; // preserve compatibility until selected is deprecated\n\n          if (selected) {\n            nextValue = selected.map(function (s) {\n              return initialOptions[s];\n            });\n          }\n\n          if (multiple) {\n            if (nextValue.indexOf(option) !== -1) {\n              nextValue = nextValue.filter(function (v) {\n                return v !== option;\n              });\n            } else {\n              nextValue.push(option);\n            }\n          } else {\n            nextValue = option;\n          }\n\n          var nextSelected = Array.isArray(nextValue) ? nextValue.map(function (v) {\n            return initialOptions.indexOf(v);\n          }) : initialOptions.indexOf(nextValue);\n          onChange({\n            option: option,\n            value: nextValue,\n            selected: nextSelected\n          });\n        }\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"clearKeyboardNavigation\", function () {\n      clearTimeout(_this.keyboardNavTimer);\n      _this.keyboardNavTimer = setTimeout(function () {\n        _this.setState({\n          keyboardNavigating: false\n        });\n      }, 100); // 100ms was empirically determined\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onNextOption\", function (event) {\n      var options = _this.props.options;\n      var activeIndex = _this.state.activeIndex;\n      event.preventDefault();\n      var nextActiveIndex = activeIndex + 1;\n\n      while (nextActiveIndex < options.length && _this.isDisabled(nextActiveIndex)) {\n        nextActiveIndex += 1;\n      }\n\n      if (nextActiveIndex !== options.length) {\n        _this.setState({\n          activeIndex: nextActiveIndex,\n          keyboardNavigating: true\n        }, function () {\n          var buttonNode = _this.optionRefs[nextActiveIndex];\n          var optionsNode = _this.optionsRef.current;\n\n          if (buttonNode && isNodeAfterScroll(buttonNode, optionsNode) && optionsNode.scrollTo) {\n            optionsNode.scrollTo(0, buttonNode.offsetTop - (optionsNode.getBoundingClientRect().height - buttonNode.getBoundingClientRect().height));\n          }\n\n          _this.clearKeyboardNavigation();\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onPreviousOption\", function (event) {\n      var activeIndex = _this.state.activeIndex;\n      event.preventDefault();\n      var nextActiveIndex = activeIndex - 1;\n\n      while (nextActiveIndex >= 0 && _this.isDisabled(nextActiveIndex)) {\n        nextActiveIndex -= 1;\n      }\n\n      if (nextActiveIndex >= 0) {\n        _this.setState({\n          activeIndex: nextActiveIndex,\n          keyboardNavigating: true\n        }, function () {\n          var buttonNode = _this.optionRefs[nextActiveIndex];\n          var optionsNode = _this.optionsRef.current;\n\n          if (buttonNode && isNodeBeforeScroll(buttonNode, optionsNode) && optionsNode.scrollTo) {\n            optionsNode.scrollTo(0, buttonNode.offsetTop);\n          }\n\n          _this.clearKeyboardNavigation();\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onActiveOption\", function (index) {\n      return function () {\n        var keyboardNavigating = _this.state.keyboardNavigating;\n\n        if (!keyboardNavigating) {\n          _this.setState({\n            activeIndex: index\n          });\n        }\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSelectOption\", function (event) {\n      var options = _this.props.options;\n      var activeIndex = _this.state.activeIndex;\n\n      if (activeIndex >= 0) {\n        event.preventDefault(); // prevent submitting forms\n\n        _this.selectOption(options[activeIndex])();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"optionLabel\", function (index) {\n      var _this$props2 = _this.props,\n          options = _this$props2.options,\n          labelKey = _this$props2.labelKey;\n      var option = options[index];\n      var optionLabel;\n\n      if (labelKey) {\n        if (typeof labelKey === 'function') {\n          optionLabel = labelKey(option);\n        } else {\n          optionLabel = option[labelKey];\n        }\n      } else {\n        optionLabel = option;\n      }\n\n      return optionLabel;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"optionValue\", function (index) {\n      var _this$props3 = _this.props,\n          options = _this$props3.options,\n          valueKey = _this$props3.valueKey;\n      var option = options[index];\n      var optionValue;\n\n      if (valueKey) {\n        if (typeof valueKey === 'function') {\n          optionValue = valueKey(option);\n        } else {\n          optionValue = option[valueKey];\n        }\n      } else {\n        optionValue = option;\n      }\n\n      return optionValue;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isDisabled\", function (index) {\n      var _this$props4 = _this.props,\n          disabled = _this$props4.disabled,\n          disabledKey = _this$props4.disabledKey,\n          options = _this$props4.options;\n      var option = options[index];\n      var result;\n\n      if (disabledKey) {\n        if (typeof disabledKey === 'function') {\n          result = disabledKey(option, index);\n        } else {\n          result = option[disabledKey];\n        }\n      } else if (Array.isArray(disabled)) {\n        if (typeof disabled[0] === 'number') {\n          result = disabled.indexOf(index) !== -1;\n        } else {\n          var optionValue = _this.optionValue(index);\n\n          result = disabled.indexOf(optionValue) !== -1;\n        }\n      }\n\n      return result;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isSelected\", function (index) {\n      var _this$props5 = _this.props,\n          selected = _this$props5.selected,\n          value = _this$props5.value,\n          valueKey = _this$props5.valueKey;\n      var result;\n\n      if (selected) {\n        // deprecated in favor of value\n        result = selected.indexOf(index) !== -1;\n      } else {\n        var optionValue = _this.optionValue(index);\n\n        if (Array.isArray(value)) {\n          if (value.length === 0) {\n            result = false;\n          } else if (typeof value[0] !== 'object') {\n            result = value.indexOf(optionValue) !== -1;\n          } else if (valueKey) {\n            result = value.some(function (valueItem) {\n              var valueValue = typeof valueKey === 'function' ? valueKey(valueItem) : valueItem[valueKey];\n              return valueValue === optionValue;\n            });\n          }\n        } else if (valueKey && typeof value === 'object') {\n          var valueValue = typeof valueKey === 'function' ? valueKey(value) : value[valueKey];\n          result = valueValue === optionValue;\n        } else {\n          result = value === optionValue;\n        }\n      }\n\n      return result;\n    });\n\n    _this.state = {\n      initialOptions: props.options,\n      search: '',\n      activeIndex: -1\n    };\n    return _this;\n  }\n\n  SelectContainer.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n    var options = nextProps.options,\n        value = nextProps.value,\n        onSearch = nextProps.onSearch;\n\n    if (onSearch) {\n      if (prevState.activeIndex === -1 && prevState.search === '' && options && value) {\n        var optionValue = Array.isArray(value) && value.length ? value[0] : value;\n        var activeIndex = options.indexOf(optionValue);\n        return {\n          activeIndex: activeIndex\n        };\n      }\n\n      if (prevState.activeIndex === -1 && prevState.search !== '') {\n        return {\n          activeIndex: 0\n        };\n      }\n    }\n\n    return null;\n  };\n\n  var _proto = SelectContainer.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    var _this2 = this;\n\n    var onSearch = this.props.onSearch;\n    var activeIndex = this.state.activeIndex; // timeout need to send the operation through event loop and allow\n    // time to the portal to be available\n\n    setTimeout(function () {\n      var optionsNode = _this2.optionsRef.current;\n\n      if (onSearch) {\n        var input = _this2.searchRef.current;\n\n        if (input && input.focus) {\n          setFocusWithoutScroll(input);\n        }\n      } else if (optionsNode) {\n        setFocusWithoutScroll(optionsNode);\n      } // scroll to active option if it is below the fold\n\n\n      if (activeIndex >= 0 && optionsNode) {\n        var optionNode = _this2.optionRefs[activeIndex];\n\n        var _optionsNode$getBound = optionsNode.getBoundingClientRect(),\n            containerBottom = _optionsNode$getBound.bottom;\n\n        if (optionNode) {\n          var _optionNode$getBoundi = optionNode.getBoundingClientRect(),\n              optionTop = _optionNode$getBoundi.bottom;\n\n          if (containerBottom < optionTop) {\n            optionNode.scrollIntoView();\n          }\n        }\n      }\n    }, 0);\n  };\n\n  _proto.render = function render() {\n    var _this3 = this;\n\n    var _this$props6 = this.props,\n        children = _this$props6.children,\n        dropHeight = _this$props6.dropHeight,\n        emptySearchMessage = _this$props6.emptySearchMessage,\n        id = _this$props6.id,\n        onMore = _this$props6.onMore,\n        onKeyDown = _this$props6.onKeyDown,\n        onSearch = _this$props6.onSearch,\n        options = _this$props6.options,\n        searchPlaceholder = _this$props6.searchPlaceholder,\n        theme = _this$props6.theme,\n        replace = _this$props6.replace;\n    var _this$state = this.state,\n        activeIndex = _this$state.activeIndex,\n        search = _this$state.search;\n    var customSearchInput = theme.select.searchInput;\n    var SelectTextInput = customSearchInput || TextInput;\n\n    var selectOptionsStyle = _extends({}, theme.select.options.box, {}, theme.select.options.container);\n\n    return React.createElement(Keyboard, {\n      onEnter: this.onSelectOption,\n      onUp: this.onPreviousOption,\n      onDown: this.onNextOption,\n      onKeyDown: onKeyDown\n    }, React.createElement(StyledContainer, {\n      as: Box,\n      id: id ? id + \"__select-drop\" : undefined,\n      dropHeight: dropHeight\n    }, onSearch && React.createElement(Box, {\n      pad: !customSearchInput ? 'xsmall' : undefined,\n      flex: false\n    }, React.createElement(SelectTextInput, {\n      focusIndicator: !customSearchInput,\n      size: \"small\",\n      ref: this.searchRef,\n      type: \"search\",\n      value: search,\n      placeholder: searchPlaceholder,\n      onChange: this.onSearchChange\n    })), React.createElement(OptionsBox, {\n      flex: \"shrink\",\n      role: \"menubar\",\n      tabIndex: \"-1\",\n      ref: this.optionsRef,\n      overflow: \"auto\"\n    }, options.length > 0 ? React.createElement(InfiniteScroll, {\n      items: options,\n      step: theme.select.step,\n      onMore: onMore,\n      replace: replace\n    }, function (option, index) {\n      var isDisabled = _this3.isDisabled(index);\n\n      var isSelected = _this3.isSelected(index);\n\n      var isActive = activeIndex === index;\n      return React.createElement(SelectOption // eslint-disable-next-line react/no-array-index-key\n      , {\n        key: index,\n        ref: function ref(_ref) {\n          _this3.optionRefs[index] = _ref;\n        },\n        disabled: isDisabled || undefined,\n        active: isActive,\n        selected: isSelected,\n        option: option,\n        onMouseOver: !isDisabled ? _this3.onActiveOption(index) : undefined,\n        onClick: !isDisabled ? _this3.selectOption(option) : undefined\n      }, children ? children(option, index, options, {\n        active: isActive,\n        disabled: isDisabled,\n        selected: isSelected\n      }) : React.createElement(OptionBox, _extends({}, selectOptionsStyle, {\n        selected: isSelected\n      }), React.createElement(Text, theme.select.options.text, _this3.optionLabel(index))));\n    }) : React.createElement(SelectOption, {\n      key: \"search_empty\",\n      disabled: true,\n      option: emptySearchMessage\n    }, React.createElement(OptionBox, selectOptionsStyle, React.createElement(Text, theme.select.container.text, emptySearchMessage))))));\n  };\n\n  return SelectContainer;\n}(Component);\n\n_defineProperty(SelectContainer, \"defaultProps\", {\n  children: null,\n  disabled: undefined,\n  emptySearchMessage: 'No matches found',\n  id: undefined,\n  multiple: false,\n  name: undefined,\n  onKeyDown: undefined,\n  onSearch: undefined,\n  options: undefined,\n  searchPlaceholder: undefined,\n  selected: undefined,\n  value: '',\n  replace: true\n});\n\nObject.setPrototypeOf(SelectContainer.defaultProps, defaultProps);\nvar SelectContainerWrapper = withTheme(SelectContainer);\nexport { SelectContainerWrapper as SelectContainer };","map":{"version":3,"sources":["/Users/qier/Documents/cs407/In-request_cs407/dev/Front-end/in-request/node_modules/grommet/es6/components/Select/SelectContainer.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","_assertThisInitialized","self","ReferenceError","_inheritsLoose","subClass","superClass","create","constructor","__proto__","_defineProperty","obj","value","defineProperty","enumerable","configurable","writable","React","createRef","Component","styled","withTheme","debounce","debounceDelay","isNodeAfterScroll","isNodeBeforeScroll","selectedStyle","setFocusWithoutScroll","defaultProps","Box","InfiniteScroll","Keyboard","Text","TextInput","SelectOption","StyledContainer","OptionsBox","withConfig","displayName","componentId","OptionBox","props","selected","SelectContainer","_Component","_this","event","setState","search","activeIndex","state","onSearch","option","_this$props","multiple","onChange","initialOptions","nextValue","Array","isArray","slice","map","s","indexOf","filter","v","push","nextSelected","clearTimeout","keyboardNavTimer","setTimeout","keyboardNavigating","options","preventDefault","nextActiveIndex","isDisabled","buttonNode","optionRefs","optionsNode","optionsRef","current","scrollTo","offsetTop","getBoundingClientRect","height","clearKeyboardNavigation","index","selectOption","_this$props2","labelKey","optionLabel","_this$props3","valueKey","optionValue","_this$props4","disabled","disabledKey","result","_this$props5","some","valueItem","valueValue","getDerivedStateFromProps","nextProps","prevState","_proto","componentDidMount","_this2","input","searchRef","focus","optionNode","_optionsNode$getBound","containerBottom","bottom","_optionNode$getBoundi","optionTop","scrollIntoView","render","_this3","_this$props6","children","dropHeight","emptySearchMessage","id","onMore","onKeyDown","searchPlaceholder","theme","replace","_this$state","customSearchInput","select","searchInput","SelectTextInput","selectOptionsStyle","box","container","createElement","onEnter","onSelectOption","onUp","onPreviousOption","onDown","onNextOption","as","undefined","pad","flex","focusIndicator","size","ref","type","placeholder","onSearchChange","role","tabIndex","overflow","items","step","isSelected","isActive","_ref","active","onMouseOver","onActiveOption","onClick","text","name","setPrototypeOf","SelectContainerWrapper"],"mappings":"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","sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { createRef, Component } from 'react';\nimport styled, { withTheme } from 'styled-components';\nimport { debounce, debounceDelay, isNodeAfterScroll, isNodeBeforeScroll, selectedStyle, setFocusWithoutScroll } from '../../utils';\nimport { defaultProps } from '../../default-props';\nimport { Box } from '../Box';\nimport { InfiniteScroll } from '../InfiniteScroll';\nimport { Keyboard } from '../Keyboard';\nimport { Text } from '../Text';\nimport { TextInput } from '../TextInput';\nimport { SelectOption } from './SelectOption';\nimport { StyledContainer } from './StyledSelect'; // position relative is so scroll can be managed correctly\n\nvar OptionsBox = styled(Box).withConfig({\n  displayName: \"SelectContainer__OptionsBox\",\n  componentId: \"sc-1wi0ul8-0\"\n})([\"position:relative;scroll-behavior:smooth;\"]);\nvar OptionBox = styled(Box).withConfig({\n  displayName: \"SelectContainer__OptionBox\",\n  componentId: \"sc-1wi0ul8-1\"\n})([\"\", \"\"], function (props) {\n  return props.selected && selectedStyle;\n});\n\nvar SelectContainer =\n/*#__PURE__*/\nfunction (_Component) {\n  _inheritsLoose(SelectContainer, _Component);\n\n  function SelectContainer(props) {\n    var _this;\n\n    _this = _Component.call(this, props) || this;\n\n    _defineProperty(_assertThisInitialized(_this), \"optionRefs\", {});\n\n    _defineProperty(_assertThisInitialized(_this), \"searchRef\", createRef());\n\n    _defineProperty(_assertThisInitialized(_this), \"optionsRef\", createRef());\n\n    _defineProperty(_assertThisInitialized(_this), \"onSearchChange\", function (event) {\n      _this.setState({\n        search: event.target.value,\n        activeIndex: -1\n      }, function () {\n        var search = _this.state.search;\n\n        _this.onSearch(search);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSearch\", debounce(function (search) {\n      var onSearch = _this.props.onSearch;\n      onSearch(search);\n    }, debounceDelay(_this.props)));\n\n    _defineProperty(_assertThisInitialized(_this), \"selectOption\", function (option) {\n      return function () {\n        var _this$props = _this.props,\n            multiple = _this$props.multiple,\n            onChange = _this$props.onChange,\n            value = _this$props.value,\n            selected = _this$props.selected;\n        var initialOptions = _this.state.initialOptions;\n\n        if (onChange) {\n          var nextValue = Array.isArray(value) ? value.slice() : []; // preserve compatibility until selected is deprecated\n\n          if (selected) {\n            nextValue = selected.map(function (s) {\n              return initialOptions[s];\n            });\n          }\n\n          if (multiple) {\n            if (nextValue.indexOf(option) !== -1) {\n              nextValue = nextValue.filter(function (v) {\n                return v !== option;\n              });\n            } else {\n              nextValue.push(option);\n            }\n          } else {\n            nextValue = option;\n          }\n\n          var nextSelected = Array.isArray(nextValue) ? nextValue.map(function (v) {\n            return initialOptions.indexOf(v);\n          }) : initialOptions.indexOf(nextValue);\n          onChange({\n            option: option,\n            value: nextValue,\n            selected: nextSelected\n          });\n        }\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"clearKeyboardNavigation\", function () {\n      clearTimeout(_this.keyboardNavTimer);\n      _this.keyboardNavTimer = setTimeout(function () {\n        _this.setState({\n          keyboardNavigating: false\n        });\n      }, 100); // 100ms was empirically determined\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onNextOption\", function (event) {\n      var options = _this.props.options;\n      var activeIndex = _this.state.activeIndex;\n      event.preventDefault();\n      var nextActiveIndex = activeIndex + 1;\n\n      while (nextActiveIndex < options.length && _this.isDisabled(nextActiveIndex)) {\n        nextActiveIndex += 1;\n      }\n\n      if (nextActiveIndex !== options.length) {\n        _this.setState({\n          activeIndex: nextActiveIndex,\n          keyboardNavigating: true\n        }, function () {\n          var buttonNode = _this.optionRefs[nextActiveIndex];\n          var optionsNode = _this.optionsRef.current;\n\n          if (buttonNode && isNodeAfterScroll(buttonNode, optionsNode) && optionsNode.scrollTo) {\n            optionsNode.scrollTo(0, buttonNode.offsetTop - (optionsNode.getBoundingClientRect().height - buttonNode.getBoundingClientRect().height));\n          }\n\n          _this.clearKeyboardNavigation();\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onPreviousOption\", function (event) {\n      var activeIndex = _this.state.activeIndex;\n      event.preventDefault();\n      var nextActiveIndex = activeIndex - 1;\n\n      while (nextActiveIndex >= 0 && _this.isDisabled(nextActiveIndex)) {\n        nextActiveIndex -= 1;\n      }\n\n      if (nextActiveIndex >= 0) {\n        _this.setState({\n          activeIndex: nextActiveIndex,\n          keyboardNavigating: true\n        }, function () {\n          var buttonNode = _this.optionRefs[nextActiveIndex];\n          var optionsNode = _this.optionsRef.current;\n\n          if (buttonNode && isNodeBeforeScroll(buttonNode, optionsNode) && optionsNode.scrollTo) {\n            optionsNode.scrollTo(0, buttonNode.offsetTop);\n          }\n\n          _this.clearKeyboardNavigation();\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onActiveOption\", function (index) {\n      return function () {\n        var keyboardNavigating = _this.state.keyboardNavigating;\n\n        if (!keyboardNavigating) {\n          _this.setState({\n            activeIndex: index\n          });\n        }\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSelectOption\", function (event) {\n      var options = _this.props.options;\n      var activeIndex = _this.state.activeIndex;\n\n      if (activeIndex >= 0) {\n        event.preventDefault(); // prevent submitting forms\n\n        _this.selectOption(options[activeIndex])();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"optionLabel\", function (index) {\n      var _this$props2 = _this.props,\n          options = _this$props2.options,\n          labelKey = _this$props2.labelKey;\n      var option = options[index];\n      var optionLabel;\n\n      if (labelKey) {\n        if (typeof labelKey === 'function') {\n          optionLabel = labelKey(option);\n        } else {\n          optionLabel = option[labelKey];\n        }\n      } else {\n        optionLabel = option;\n      }\n\n      return optionLabel;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"optionValue\", function (index) {\n      var _this$props3 = _this.props,\n          options = _this$props3.options,\n          valueKey = _this$props3.valueKey;\n      var option = options[index];\n      var optionValue;\n\n      if (valueKey) {\n        if (typeof valueKey === 'function') {\n          optionValue = valueKey(option);\n        } else {\n          optionValue = option[valueKey];\n        }\n      } else {\n        optionValue = option;\n      }\n\n      return optionValue;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isDisabled\", function (index) {\n      var _this$props4 = _this.props,\n          disabled = _this$props4.disabled,\n          disabledKey = _this$props4.disabledKey,\n          options = _this$props4.options;\n      var option = options[index];\n      var result;\n\n      if (disabledKey) {\n        if (typeof disabledKey === 'function') {\n          result = disabledKey(option, index);\n        } else {\n          result = option[disabledKey];\n        }\n      } else if (Array.isArray(disabled)) {\n        if (typeof disabled[0] === 'number') {\n          result = disabled.indexOf(index) !== -1;\n        } else {\n          var optionValue = _this.optionValue(index);\n\n          result = disabled.indexOf(optionValue) !== -1;\n        }\n      }\n\n      return result;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isSelected\", function (index) {\n      var _this$props5 = _this.props,\n          selected = _this$props5.selected,\n          value = _this$props5.value,\n          valueKey = _this$props5.valueKey;\n      var result;\n\n      if (selected) {\n        // deprecated in favor of value\n        result = selected.indexOf(index) !== -1;\n      } else {\n        var optionValue = _this.optionValue(index);\n\n        if (Array.isArray(value)) {\n          if (value.length === 0) {\n            result = false;\n          } else if (typeof value[0] !== 'object') {\n            result = value.indexOf(optionValue) !== -1;\n          } else if (valueKey) {\n            result = value.some(function (valueItem) {\n              var valueValue = typeof valueKey === 'function' ? valueKey(valueItem) : valueItem[valueKey];\n              return valueValue === optionValue;\n            });\n          }\n        } else if (valueKey && typeof value === 'object') {\n          var valueValue = typeof valueKey === 'function' ? valueKey(value) : value[valueKey];\n          result = valueValue === optionValue;\n        } else {\n          result = value === optionValue;\n        }\n      }\n\n      return result;\n    });\n\n    _this.state = {\n      initialOptions: props.options,\n      search: '',\n      activeIndex: -1\n    };\n    return _this;\n  }\n\n  SelectContainer.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n    var options = nextProps.options,\n        value = nextProps.value,\n        onSearch = nextProps.onSearch;\n\n    if (onSearch) {\n      if (prevState.activeIndex === -1 && prevState.search === '' && options && value) {\n        var optionValue = Array.isArray(value) && value.length ? value[0] : value;\n        var activeIndex = options.indexOf(optionValue);\n        return {\n          activeIndex: activeIndex\n        };\n      }\n\n      if (prevState.activeIndex === -1 && prevState.search !== '') {\n        return {\n          activeIndex: 0\n        };\n      }\n    }\n\n    return null;\n  };\n\n  var _proto = SelectContainer.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    var _this2 = this;\n\n    var onSearch = this.props.onSearch;\n    var activeIndex = this.state.activeIndex; // timeout need to send the operation through event loop and allow\n    // time to the portal to be available\n\n    setTimeout(function () {\n      var optionsNode = _this2.optionsRef.current;\n\n      if (onSearch) {\n        var input = _this2.searchRef.current;\n\n        if (input && input.focus) {\n          setFocusWithoutScroll(input);\n        }\n      } else if (optionsNode) {\n        setFocusWithoutScroll(optionsNode);\n      } // scroll to active option if it is below the fold\n\n\n      if (activeIndex >= 0 && optionsNode) {\n        var optionNode = _this2.optionRefs[activeIndex];\n\n        var _optionsNode$getBound = optionsNode.getBoundingClientRect(),\n            containerBottom = _optionsNode$getBound.bottom;\n\n        if (optionNode) {\n          var _optionNode$getBoundi = optionNode.getBoundingClientRect(),\n              optionTop = _optionNode$getBoundi.bottom;\n\n          if (containerBottom < optionTop) {\n            optionNode.scrollIntoView();\n          }\n        }\n      }\n    }, 0);\n  };\n\n  _proto.render = function render() {\n    var _this3 = this;\n\n    var _this$props6 = this.props,\n        children = _this$props6.children,\n        dropHeight = _this$props6.dropHeight,\n        emptySearchMessage = _this$props6.emptySearchMessage,\n        id = _this$props6.id,\n        onMore = _this$props6.onMore,\n        onKeyDown = _this$props6.onKeyDown,\n        onSearch = _this$props6.onSearch,\n        options = _this$props6.options,\n        searchPlaceholder = _this$props6.searchPlaceholder,\n        theme = _this$props6.theme,\n        replace = _this$props6.replace;\n    var _this$state = this.state,\n        activeIndex = _this$state.activeIndex,\n        search = _this$state.search;\n    var customSearchInput = theme.select.searchInput;\n    var SelectTextInput = customSearchInput || TextInput;\n\n    var selectOptionsStyle = _extends({}, theme.select.options.box, {}, theme.select.options.container);\n\n    return React.createElement(Keyboard, {\n      onEnter: this.onSelectOption,\n      onUp: this.onPreviousOption,\n      onDown: this.onNextOption,\n      onKeyDown: onKeyDown\n    }, React.createElement(StyledContainer, {\n      as: Box,\n      id: id ? id + \"__select-drop\" : undefined,\n      dropHeight: dropHeight\n    }, onSearch && React.createElement(Box, {\n      pad: !customSearchInput ? 'xsmall' : undefined,\n      flex: false\n    }, React.createElement(SelectTextInput, {\n      focusIndicator: !customSearchInput,\n      size: \"small\",\n      ref: this.searchRef,\n      type: \"search\",\n      value: search,\n      placeholder: searchPlaceholder,\n      onChange: this.onSearchChange\n    })), React.createElement(OptionsBox, {\n      flex: \"shrink\",\n      role: \"menubar\",\n      tabIndex: \"-1\",\n      ref: this.optionsRef,\n      overflow: \"auto\"\n    }, options.length > 0 ? React.createElement(InfiniteScroll, {\n      items: options,\n      step: theme.select.step,\n      onMore: onMore,\n      replace: replace\n    }, function (option, index) {\n      var isDisabled = _this3.isDisabled(index);\n\n      var isSelected = _this3.isSelected(index);\n\n      var isActive = activeIndex === index;\n      return React.createElement(SelectOption // eslint-disable-next-line react/no-array-index-key\n      , {\n        key: index,\n        ref: function ref(_ref) {\n          _this3.optionRefs[index] = _ref;\n        },\n        disabled: isDisabled || undefined,\n        active: isActive,\n        selected: isSelected,\n        option: option,\n        onMouseOver: !isDisabled ? _this3.onActiveOption(index) : undefined,\n        onClick: !isDisabled ? _this3.selectOption(option) : undefined\n      }, children ? children(option, index, options, {\n        active: isActive,\n        disabled: isDisabled,\n        selected: isSelected\n      }) : React.createElement(OptionBox, _extends({}, selectOptionsStyle, {\n        selected: isSelected\n      }), React.createElement(Text, theme.select.options.text, _this3.optionLabel(index))));\n    }) : React.createElement(SelectOption, {\n      key: \"search_empty\",\n      disabled: true,\n      option: emptySearchMessage\n    }, React.createElement(OptionBox, selectOptionsStyle, React.createElement(Text, theme.select.container.text, emptySearchMessage))))));\n  };\n\n  return SelectContainer;\n}(Component);\n\n_defineProperty(SelectContainer, \"defaultProps\", {\n  children: null,\n  disabled: undefined,\n  emptySearchMessage: 'No matches found',\n  id: undefined,\n  multiple: false,\n  name: undefined,\n  onKeyDown: undefined,\n  onSearch: undefined,\n  options: undefined,\n  searchPlaceholder: undefined,\n  selected: undefined,\n  value: '',\n  replace: true\n});\n\nObject.setPrototypeOf(SelectContainer.defaultProps, defaultProps);\nvar SelectContainerWrapper = withTheme(SelectContainer);\nexport { SelectContainerWrapper as SelectContainer };"]},"metadata":{},"sourceType":"module"}