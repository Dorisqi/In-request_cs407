{"ast":null,"code":"var _jsxFileName = \"/Users/qier/Documents/cs407/In-request_cs407/dev/Front-end/in-request/src/Components/Home/Posts.js\";\nimport React, { Component } from 'react';\nimport { fdb, auth, storage } from \"../../firebase\";\nimport { withStyles, makeStyles, ThemeProvider } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport Grid from '@material-ui/core/Grid';\nimport Chip from '@material-ui/core/Chip';\nimport LocationOnIcon from '@material-ui/icons/LocationOn';\nimport FlashOnIcon from '@material-ui/icons/FlashOn';\nimport Container from '@material-ui/core/Container';\nimport AppsIcon from '@material-ui/icons/Apps';\nimport { grommet, Grommet, FormField, TextInput, InfiniteScroll, Box, Text } from \"grommet\";\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Avatar from \"@material-ui/core/Avatar\";\n/* ---  THIS FILE CONTAINS ALL THE POSTS --- */\n\nconst styles = theme => ({\n  root: {\n    minWidth: 275,\n    margin: 10\n  },\n  bullet: {\n    display: 'inline-block',\n    margin: '0 2px',\n    transform: 'scale(0.8)'\n  },\n  title: {\n    fontSize: 14\n  },\n  pos: {\n    marginBottom: 12\n  },\n  label_size: {\n    fontSize: 8\n  }\n});\n\nclass Posts extends Component {\n  constructor(props) {\n    super(props);\n\n    this.print_data = event => {\n      console.log(this.state.post_list);\n    };\n\n    this.on_Change_content = event => {\n      const value = event.target.value;\n      console.log(value);\n      this.setState({\n        content: value\n      });\n    };\n\n    this.add_Comment = event => {\n      const status = this.state.add_cmt == 0 ? 1 : 0;\n      this.setState({\n        add_cmt: status\n      });\n    };\n\n    this.handleClick1 = event => {\n      const value = this.state.color1 == 1 ? 0 : 1;\n      this.setState({\n        color1: value\n      });\n    };\n\n    this.handleClick2 = event => {\n      const value = this.state.color2 == 1 ? 0 : 1;\n      this.setState({\n        color2: value\n      });\n    };\n\n    this.handleClick3 = event => {\n      const value = this.state.color3 == 1 ? 0 : 1;\n      this.setState({\n        color3: value\n      });\n    };\n\n    this.handleClick4 = event => {\n      const value = this.state.color4 == 1 ? 0 : 1;\n      this.setState({\n        color4: value\n      });\n    };\n\n    this.handleClick5 = event => {\n      const value = this.state.color5 == 1 ? 0 : 1;\n      this.setState({\n        color5: value,\n        color6: 0,\n        color7: 0\n      });\n    };\n\n    this.handleClick6 = event => {\n      const value = this.state.color6 == 1 ? 0 : 1;\n      this.setState({\n        color6: value,\n        color5: 0,\n        color7: 0\n      });\n    };\n\n    this.handleClick7 = event => {\n      const value = this.state.color7 == 1 ? 0 : 1;\n      this.setState({\n        color7: value,\n        color5: 0,\n        color6: 0\n      });\n    };\n\n    this.handleClick8 = event => {\n      const value = this.state.color8 == 1 ? 0 : 1;\n      this.setState({\n        color8: value\n      });\n    };\n\n    this.handleClick9 = event => {\n      const value = this.state.color9 == 1 ? 0 : 1;\n      this.setState({\n        color9: value\n      });\n    };\n\n    this.handleClick11 = event => {\n      const value = this.state.color11 == 1 ? 0 : 1;\n      this.setState({\n        color11: value\n      });\n    };\n\n    this.handleClick12 = event => {\n      const value = this.state.color12 == 1 ? 0 : 1;\n      this.setState({\n        color12: value\n      });\n    };\n\n    this.state = {\n      filterList: [],\n      post_list: [],\n      comment_list: {},\n      storage: storage,\n      color1: 0,\n      color2: 0,\n      color3: 0,\n      color4: 0,\n      color5: 0,\n      color6: 0,\n      color7: 0,\n      color8: 0,\n      color9: 0,\n      color11: 0,\n      color12: 0,\n      open: false,\n      url: \"\",\n      add_cmt: 0,\n      content: \"\",\n      photo_map: [],\n      temp_comments: [],\n      user_email: this.props.Email,\n      user_nickname: this.props.Nickname,\n      control_comment_map: []\n    };\n    this.handleClick1 = this.handleClick1.bind(this);\n    this.handleClick2 = this.handleClick2.bind(this);\n    this.handleClick3 = this.handleClick3.bind(this);\n    this.handleClick4 = this.handleClick4.bind(this);\n    this.handleClick5 = this.handleClick5.bind(this);\n    this.handleClick6 = this.handleClick6.bind(this);\n    this.handleClick7 = this.handleClick7.bind(this);\n    this.handleClick8 = this.handleClick8.bind(this);\n    this.handleClick9 = this.handleClick9.bind(this);\n    this.handleClick11 = this.handleClick11.bind(this);\n    this.handleClick12 = this.handleClick12.bind(this);\n    this.onClick_Open = this.onClick_Open.bind(this);\n    this.get_url = this.get_url.bind(this);\n    this.add_Comment = this.add_Comment.bind(this);\n    this.on_Submit = this.on_Submit.bind(this);\n    this.on_Change_content = this.on_Change_content.bind(this);\n    this.delete_Comment = this.delete_Comment.bind(this);\n    this.onclickLend = this.onclickLend.bind(this);\n    this.print_data = this.print_data.bind(this);\n  }\n\n  componentDidMount() {\n    let requests_collection = fdb.collection('requests');\n    let all_requests = requests_collection.where('status', '==', 'active').get().then(snapshot => {\n      snapshot.forEach(doc => {\n        const item = doc.data();\n        const new_item = item;\n        new_item['id'] = doc.id; //console.log(new_item)\n\n        new_item['comment_flag'] = false;\n        this.setState({\n          post_list: [...this.state.post_list, new_item]\n        });\n      });\n    }).catch(err => {\n      console.log('Error getting documents', err);\n    }); //store all image info:\n\n    let photo_dic = {};\n    let user_collection = fdb.collection('users');\n    fdb.collection('users').where('photostate', '==', true).get().then(snapshot => {\n      snapshot.forEach(doc => {\n        const item = doc.data();\n        const email = item.email; //get url from firebase storage by user email\n\n        storage.ref('images').child(email).getDownloadURL().then(url => {\n          photo_dic[email] = url;\n          this.setState({\n            photo_map: photo_dic\n          });\n        }).catch(err => {\n          console.log('Error getting image', err);\n          photo_dic[email] = \"\";\n        }); ////////geting url finish\n      });\n    }).catch(err => {\n      console.log('Error getting documents', err);\n    });\n  }\n\n  onClick_Open(postid) {\n    const status = this.state.control_comment_map[postid] == true ? false : true;\n    this.setState({\n      post_list: this.state.post_list.map(el => el.id === postid ? { ...el,\n        comment_flag: status\n      } : el)\n    });\n  }\n\n  onclickLend(post) {\n    var user = auth.currentUser;\n    var upd = fdb.collection(\"requests\").doc(post.id);\n    upd.update({\n      msaccepted: true,\n      lender: user\n    });\n  } // update_post(ref){\n  //   console.log(\"update_post id\",ref.id);\n  //   console.log(\"commenis:\",this.state.temp_comments)\n  //\n  //   const new_post=this.state.post_list.map(ele => (ele.id === ref.id ? {comments:this.state.temp_comments} : ele))\n  //   // this.setState({\n  //   //     post_list: this.state.post_list.map(el => (el.id === ref.id ? {...el, comments} : el))\n  //   //   });\n  //\n  //   console.log(\"after setstate:\",this.state.post_list)\n  //   return this.setState({\n  //     post_list:new_post\n  //   });\n  //\n  // }\n\n\n  delete_Comment(content, email, postid) {\n    let new_comment_list = [];\n    const post = this.state.post_list.filter(obj => obj.id.includes(postid));\n    const old_comments = post[0].comments;\n    let new_comments = [];\n    let i = 0;\n\n    while (i < old_comments.length) {\n      if (old_comments[i].content === content && old_comments[i].email === email) {} else {\n        new_comments.push(old_comments[i]);\n      }\n\n      i = i + 1;\n    }\n\n    console.log(\"delete post info\", new_comments); //new_cmts=doc.data().comments\n\n    this.setState({\n      post_list: this.state.post_list.map(el => el.id === postid ? { ...el,\n        comments: new_comments\n      } : el)\n    });\n    fdb.collection('requests').doc(postid).update({\n      comments: new_comments\n    });\n  }\n\n  on_Submit(ref) {\n    //console.log(ref)\n    //let document =\n    let old = \"\";\n    let new_comment = {\n      email: this.props.Email,\n      nickname: this.props.Nickname,\n      content: this.state.content\n    };\n    let new_cmts = []; //const component = this\n\n    fdb.collection('requests').doc(ref.id).get().then(doc => {\n      console.log(\"Document data:\", doc.data());\n      old = doc.data(); //new_cmts=doc.data().comments\n\n      if (doc.data().comments == null || doc.data().comments.length == 0) {\n        new_cmts = [new_comment];\n      } else {\n        new_cmts = doc.data().comments.concat(new_comment);\n      }\n\n      console.log(\"new comment:\", new_cmts);\n      this.setState({\n        post_list: this.state.post_list.map(el => el.id === ref.id ? { ...el,\n          comments: new_cmts\n        } : el)\n      });\n      fdb.collection('requests').doc(ref.id).update({\n        comments: new_cmts\n      });\n    }).catch(function (error) {\n      console.log(\"Error getting document:\", error);\n    });\n    return;\n  }\n\n  get_url(email) {\n    let url_ = \"\"; //console.log(storage.ref('images').child(email).getDownloadURL())\n\n    storage.ref('images').child(email).getDownloadURL().then(url => {\n      console.log(url);\n      url_ = url;\n      console.log(url);\n      return url;\n    }).catch(err => {\n      this.setState({\n        url: \"\"\n      });\n      console.log('Error getting image', err);\n    }); // console.log(url_)\n\n    return url_;\n  }\n\n  render() {\n    const {\n      classes\n    } = this.props;\n    const {\n      post_list,\n      color1,\n      color2,\n      color3,\n      color4,\n      color5,\n      color6,\n      color7,\n      color8,\n      color9,\n      color11,\n      color12\n    } = this.state;\n    let buffer = [];\n    let filtered = [];\n\n    if (color1) {\n      const result = post_list.filter(obj => obj.taglist.includes(\"HICKS\"));\n      buffer.push.apply(buffer, result);\n    }\n\n    if (color2) {\n      const result = post_list.filter(obj => obj.taglist.includes(\"PMU\"));\n      buffer.push.apply(buffer, result);\n    }\n\n    if (color3) {\n      const result = post_list.filter(obj => obj.taglist.includes(\"LWSN\"));\n      buffer.push.apply(buffer, result);\n    }\n\n    if (color4) {\n      const result = post_list.filter(obj => obj.taglist.includes(\"ECE\"));\n      buffer.push.apply(buffer, result);\n    }\n\n    if (color5) {\n      const result = post_list.filter(obj => obj.taglist.includes(\"LEVEL1\"));\n      buffer.push.apply(buffer, result);\n    }\n\n    if (color6) {\n      const result = post_list.filter(obj => obj.taglist.includes(\"LEVEL2\"));\n      buffer.push.apply(buffer, result);\n    }\n\n    if (color7) {\n      const result = post_list.filter(obj => obj.taglist.includes(\"LEVEL3\"));\n      buffer.push.apply(buffer, result);\n    }\n\n    if (color8) {\n      const result = post_list.filter(obj => obj.taglist.includes(\"Stationery\"));\n      buffer.push.apply(buffer, result);\n    }\n\n    if (color9) {\n      const result = post_list.filter(obj => obj.taglist.includes(\"Commute\"));\n      buffer.push.apply(buffer, result);\n    }\n\n    if (color11) {\n      const result = post_list.filter(obj => obj.taglist.includes(\"Living Essentials\"));\n      buffer.push.apply(buffer, result);\n    }\n\n    if (color12) {\n      const result = post_list.filter(obj => obj.taglist.includes(\"Sports\"));\n      buffer.push.apply(buffer, result);\n    }\n\n    if (buffer.length == 0) {\n      filtered = post_list;\n    } else {\n      filtered = [...new Set(buffer)];\n    }\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 385\n      },\n      __self: this\n    }, React.createElement(Container, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 386\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      container: true,\n      spacing: 1,\n      alignItems: \"flex-end\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 387\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      item: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 388\n      },\n      __self: this\n    }, React.createElement(LocationOnIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 389\n      },\n      __self: this\n    })), React.createElement(Grid, {\n      item: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 391\n      },\n      __self: this\n    }, React.createElement(Chip, {\n      variant: \"outlined\",\n      size: \"small\",\n      label: \"HICKS\",\n      color: this.state.color1 == 0 ? \"default\" : \"primary\",\n      onClick: this.handleClick1,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 392\n      },\n      __self: this\n    })), React.createElement(Grid, {\n      item: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 394\n      },\n      __self: this\n    }, React.createElement(Chip, {\n      variant: \"outlined\",\n      size: \"small\",\n      label: \"LWSN\",\n      color: this.state.color2 == 0 ? \"default\" : \"primary\",\n      onClick: this.handleClick2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 395\n      },\n      __self: this\n    })), React.createElement(Grid, {\n      item: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 397\n      },\n      __self: this\n    }, React.createElement(Chip, {\n      variant: \"outlined\",\n      size: \"small\",\n      label: \"PMU\",\n      color: this.state.color3 == 0 ? \"default\" : \"primary\",\n      onClick: this.handleClick3,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 398\n      },\n      __self: this\n    })), React.createElement(Grid, {\n      item: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 400\n      },\n      __self: this\n    }, React.createElement(Chip, {\n      variant: \"outlined\",\n      size: \"small\",\n      label: \"ECE\",\n      color: this.state.color4 == 0 ? \"default\" : \"primary\",\n      onClick: this.handleClick4,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 401\n      },\n      __self: this\n    }))), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 404\n      },\n      __self: this\n    }), React.createElement(Grid, {\n      container: true,\n      spacing: 1,\n      alignItems: \"flex-end\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 405\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      item: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 406\n      },\n      __self: this\n    }, React.createElement(FlashOnIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 407\n      },\n      __self: this\n    })), React.createElement(Grid, {\n      item: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 409\n      },\n      __self: this\n    }, React.createElement(Chip, {\n      variant: \"outlined\",\n      size: \"small\",\n      label: \"Level 1\",\n      color: this.state.color5 == 0 ? \"default\" : \"primary\",\n      onClick: this.handleClick5,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 410\n      },\n      __self: this\n    })), React.createElement(Grid, {\n      item: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 412\n      },\n      __self: this\n    }, React.createElement(Chip, {\n      variant: \"outlined\",\n      size: \"small\",\n      label: \"Level 2\",\n      color: this.state.color6 == 0 ? \"default\" : \"primary\",\n      onClick: this.handleClick6,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 413\n      },\n      __self: this\n    })), React.createElement(Grid, {\n      item: true,\n      xs: 6,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 415\n      },\n      __self: this\n    }, React.createElement(Chip, {\n      variant: \"outlined\",\n      size: \"small\",\n      label: \"Level 3\",\n      color: this.state.color7 == 0 ? \"default\" : \"primary\",\n      onClick: this.handleClick7,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 416\n      },\n      __self: this\n    }))), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 419\n      },\n      __self: this\n    }), React.createElement(Grid, {\n      container: true,\n      spacing: 1,\n      alignItems: \"flex-end\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 420\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      item: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 421\n      },\n      __self: this\n    }, React.createElement(AppsIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 422\n      },\n      __self: this\n    })), React.createElement(Grid, {\n      item: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 424\n      },\n      __self: this\n    }, React.createElement(Chip, {\n      variant: \"outlined\",\n      size: \"small\",\n      label: \"Stationery\",\n      color: this.state.color8 == 0 ? \"default\" : \"primary\",\n      onClick: this.handleClick8,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 425\n      },\n      __self: this\n    })), React.createElement(Grid, {\n      item: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 427\n      },\n      __self: this\n    }, React.createElement(Chip, {\n      variant: \"outlined\",\n      size: \"small\",\n      label: \"Commute\",\n      color: this.state.color9 == 0 ? \"default\" : \"primary\",\n      onClick: this.handleClick9,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 428\n      },\n      __self: this\n    })), React.createElement(Grid, {\n      item: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 430\n      },\n      __self: this\n    }, React.createElement(Chip, {\n      variant: \"outlined\",\n      size: \"small\",\n      label: \"Living Essentials\",\n      color: this.state.color11 == 0 ? \"default\" : \"primary\",\n      onClick: this.handleClick11,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 431\n      },\n      __self: this\n    })), React.createElement(Grid, {\n      item: true,\n      xs: 6,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 433\n      },\n      __self: this\n    }, React.createElement(Chip, {\n      variant: \"outlined\",\n      size: \"small\",\n      label: \"Sports\",\n      color: this.state.color12 == 0 ? \"default\" : \"primary\",\n      onClick: this.handleClick12,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 434\n      },\n      __self: this\n    })))), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 438\n      },\n      __self: this\n    }), React.createElement(Grid, {\n      container: true,\n      xs: 12,\n      spacing: 3,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 439\n      },\n      __self: this\n    }, filtered.map(post => React.createElement(Grid, {\n      item: true,\n      xs: 4,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 441\n      },\n      __self: this\n    }, React.createElement(Card, {\n      background: \"#f5edf1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 442\n      },\n      __self: this\n    }, React.createElement(CardContent, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 443\n      },\n      __self: this\n    }, React.createElement(Typography, {\n      variant: \"h4\",\n      component: \"h2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 444\n      },\n      __self: this\n    }, post.title), React.createElement(Typography, {\n      variant: \"h5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 447\n      },\n      __self: this\n    }, post.content), React.createElement(Typography, {\n      variant: \"h6\",\n      component: \"p\",\n      color: \"textSecondary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 450\n      },\n      __self: this\n    }, \"Borrower: \", post.borrower, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 452\n      },\n      __self: this\n    })), React.createElement(Typography, {\n      variant: \"body1\",\n      component: \"p\",\n      color: \"textSecondary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 454\n      },\n      __self: this\n    }, \"Estimated Value: \", post.price, \" $\", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 456\n      },\n      __self: this\n    })), React.createElement(Typography, {\n      variant: \"h6\",\n      component: \"p\",\n      color: \"textSecondary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 458\n      },\n      __self: this\n    }, \"Guranrtor: \", post.guarantor, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 460\n      },\n      __self: this\n    })), React.createElement(Box, {\n      height: \"auto\",\n      overflow: \"auto\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 462\n      },\n      __self: this\n    }, post.comment_flag[post.id] && React.createElement(InfiniteScroll, {\n      items: post.comments,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 464\n      },\n      __self: this\n    }, item => React.createElement(Box, {\n      flex: false,\n      pad: \"small\",\n      background: \"#f5edf1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 467\n      },\n      __self: this\n    }, React.createElement(Tooltip, {\n      title: item.nickname,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 473\n      },\n      __self: this\n    }, React.createElement(Avatar, {\n      size: \"small\",\n      src: this.state.photo_map[item.email],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 474\n      },\n      __self: this\n    })), React.createElement(Typography, {\n      variant: \"h6\",\n      component: \"p\",\n      color: \"textSecondary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 477\n      },\n      __self: this\n    }, item.nickname, \" : \", item.content, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 479\n      },\n      __self: this\n    })), this.props.Email == post.borrower && this.props.Email != item.email && React.createElement(Button, {\n      size: \"small\",\n      onClick: () => this.onclickLend(post),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 482\n      },\n      __self: this\n    }, \"Lend from \", item.nickname), this.props.Email == item.email && React.createElement(Button, {\n      size: \"small\",\n      onClick: () => this.delete_Comment(item.content, item.email, post.id),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 486\n      },\n      __self: this\n    }, \"Delete above comment\")))), React.createElement(Grommet, {\n      theme: grommet,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 495\n      },\n      __self: this\n    }, React.createElement(FormField, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 497\n      },\n      __self: this\n    }, React.createElement(TextInput, {\n      onChange: this.on_Change_content,\n      placeholder: \"Add Comments here:\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 498\n      },\n      __self: this\n    })), React.createElement(Button, {\n      size: \"small\",\n      onClick: () => this.on_Submit(post),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 500\n      },\n      __self: this\n    }, \"Submit\"))), React.createElement(CardActions, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 504\n      },\n      __self: this\n    }, React.createElement(Button, {\n      size: \"small\",\n      onClick: () => this.onClick_Open(post.id),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 506\n      },\n      __self: this\n    }, \"Comments\"), React.createElement(Button, {\n      size: \"small\",\n      onClick: this.add_Comment,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 507\n      },\n      __self: this\n    }, \"Add Comments\")))))));\n  }\n\n}\n\nexport default withStyles(styles, {\n  withTheme: true\n})(Posts);\n;","map":{"version":3,"sources":["/Users/qier/Documents/cs407/In-request_cs407/dev/Front-end/in-request/src/Components/Home/Posts.js"],"names":["React","Component","fdb","auth","storage","withStyles","makeStyles","ThemeProvider","Card","CardActions","CardContent","Button","Typography","Grid","Chip","LocationOnIcon","FlashOnIcon","Container","AppsIcon","grommet","Grommet","FormField","TextInput","InfiniteScroll","Box","Text","Tooltip","Avatar","styles","theme","root","minWidth","margin","bullet","display","transform","title","fontSize","pos","marginBottom","label_size","Posts","constructor","props","print_data","event","console","log","state","post_list","on_Change_content","value","target","setState","content","add_Comment","status","add_cmt","handleClick1","color1","handleClick2","color2","handleClick3","color3","handleClick4","color4","handleClick5","color5","color6","color7","handleClick6","handleClick7","handleClick8","color8","handleClick9","color9","handleClick11","color11","handleClick12","color12","filterList","comment_list","open","url","photo_map","temp_comments","user_email","Email","user_nickname","Nickname","control_comment_map","bind","onClick_Open","get_url","on_Submit","delete_Comment","onclickLend","componentDidMount","requests_collection","collection","all_requests","where","get","then","snapshot","forEach","doc","item","data","new_item","id","catch","err","photo_dic","user_collection","email","ref","child","getDownloadURL","postid","map","el","comment_flag","post","user","currentUser","upd","update","msaccepted","lender","new_comment_list","filter","obj","includes","old_comments","comments","new_comments","i","length","push","old","new_comment","nickname","new_cmts","concat","error","url_","render","classes","buffer","filtered","result","taglist","apply","Set","borrower","price","guarantor","withTheme"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport {fdb,auth,storage} from \"../../firebase\";\nimport { withStyles, makeStyles, ThemeProvider } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport Grid from '@material-ui/core/Grid';\nimport Chip from '@material-ui/core/Chip';\nimport LocationOnIcon from '@material-ui/icons/LocationOn';\nimport FlashOnIcon from '@material-ui/icons/FlashOn';\nimport Container from '@material-ui/core/Container';\nimport AppsIcon from '@material-ui/icons/Apps';\nimport { grommet,Grommet,FormField,TextInput,InfiniteScroll,Box,Text} from \"grommet\";\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Avatar from \"@material-ui/core/Avatar\";\n\n\n\n/* ---  THIS FILE CONTAINS ALL THE POSTS --- */\nconst styles = theme => ({\n  root: {\n    minWidth: 275,\n    margin: 10,\n  },\n  bullet: {\n    display: 'inline-block',\n    margin: '0 2px',\n    transform: 'scale(0.8)',\n  },\n  title: {\n    fontSize: 14,\n  },\n  pos: {\n    marginBottom: 12,\n  },\n  label_size:{\n    fontSize:8,\n  }\n});\n\nclass Posts extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      filterList:[],\n      post_list: [],\n      comment_list:{},\n      storage:storage,\n      color1:0,\n      color2:0,\n      color3:0,\n      color4:0,\n      color5:0,\n      color6:0,\n      color7:0,\n      color8:0,\n      color9:0,\n      color11:0,\n      color12:0,\n      open:false,\n      url:\"\",\n      add_cmt:0,\n      content:\"\",\n      photo_map:[],\n      temp_comments:[],\n      user_email:this.props.Email,\n      user_nickname:this.props.Nickname,\n      control_comment_map:[]\n    };\n    this.handleClick1 = this.handleClick1.bind(this);\n    this.handleClick2 = this.handleClick2.bind(this);\n    this.handleClick3 = this.handleClick3.bind(this);\n    this.handleClick4 = this.handleClick4.bind(this);\n    this.handleClick5 = this.handleClick5.bind(this);\n    this.handleClick6 = this.handleClick6.bind(this);\n    this.handleClick7 = this.handleClick7.bind(this);\n    this.handleClick8 = this.handleClick8.bind(this);\n    this.handleClick9 = this.handleClick9.bind(this);\n    this.handleClick11 = this.handleClick11.bind(this);\n    this.handleClick12 = this.handleClick12.bind(this);\n    this.onClick_Open = this.onClick_Open.bind(this);\n    this.get_url=this.get_url.bind(this)\n    this.add_Comment=this.add_Comment.bind(this)\n    this.on_Submit=this.on_Submit.bind(this)\n    this.on_Change_content=this.on_Change_content.bind(this)\n    this.delete_Comment=this.delete_Comment.bind(this)\n    this.onclickLend=this.onclickLend.bind(this)\n    this.print_data=this.print_data.bind(this)\n  }\n  componentDidMount() {\n    let requests_collection = fdb.collection('requests');\n    let all_requests = requests_collection.where('status', '==', 'active').get()\n      .then(snapshot => {\n        snapshot.forEach(doc => {\n          const item = doc.data();\n          const new_item = item\n          new_item['id']=doc.id\n          //console.log(new_item)\n          new_item['comment_flag']=false\n\n          this.setState({\n              post_list: [...this.state.post_list, new_item],\n\n          });\n        });\n      }).catch(err => {\n        console.log('Error getting documents', err);\n      });\n\n      //store all image info:\n      let photo_dic={}\n      let user_collection = fdb.collection('users');\n      fdb.collection('users').where('photostate','==',true).get().then(snapshot => {\n          snapshot.forEach(doc => {\n            const item = doc.data();\n            const email = item.email\n            //get url from firebase storage by user email\n            storage.ref('images').child(email).getDownloadURL().then(url => {\n                photo_dic[email]=url\n                this.setState({photo_map:photo_dic})\n            }).catch(err => {\n              console.log('Error getting image', err);\n              photo_dic[email]=\"\"\n            });\n\n            ////////geting url finish\n\n          });\n        }).catch(err => {\n          console.log('Error getting documents', err);\n        });\n\n\n  }\n\n  onClick_Open(postid){\n\n    const status = this.state.control_comment_map[postid]==true ? false:true\n    this.setState({post_list:this.state.post_list.map(el => (el.id === postid ? {...el, comment_flag:status} : el))})\n  }\n\n  print_data=event=>{\n    console.log(this.state.post_list)\n  }\n\n  onclickLend(post){\n  var user = auth.currentUser;\n  var upd = fdb.collection(\"requests\").doc(post.id);\n  upd.update({\n    msaccepted:true,\n    lender: user,\n  })\n}\n\n  // update_post(ref){\n  //   console.log(\"update_post id\",ref.id);\n  //   console.log(\"commenis:\",this.state.temp_comments)\n  //\n  //   const new_post=this.state.post_list.map(ele => (ele.id === ref.id ? {comments:this.state.temp_comments} : ele))\n  //   // this.setState({\n  //   //     post_list: this.state.post_list.map(el => (el.id === ref.id ? {...el, comments} : el))\n  //   //   });\n  //\n  //   console.log(\"after setstate:\",this.state.post_list)\n  //   return this.setState({\n  //     post_list:new_post\n  //   });\n  //\n  // }\n\n  delete_Comment(content,email,postid){\n    let new_comment_list=[];\n    const post = this.state.post_list.filter(obj =>(obj.id.includes(postid)));\n    const old_comments=post[0].comments;\n    let new_comments=[];\n    let i = 0\n    while(i < old_comments.length){\n      if((old_comments[i].content ===content)&&(old_comments[i].email === email)){\n      }else{\n        new_comments.push(old_comments[i])\n      }\n      i=i+1;\n    }\n\n    console.log(\"delete post info\",new_comments)\n          //new_cmts=doc.data().comments\n    this.setState({\n        post_list: this.state.post_list.map(el => (el.id === postid ? {...el, comments:new_comments} : el))\n      });\n\n    fdb.collection('requests').doc(postid).update({\n        comments:new_comments\n      });\n\n\n\n  }\n  on_Submit(ref){\n    //console.log(ref)\n    //let document =\n    let old=\"\"\n    let new_comment={\n      email:this.props.Email,\n      nickname:this.props.Nickname,\n      content:this.state.content\n    }\n    let new_cmts=[]\n    //const component = this\n    fdb.collection('requests').doc(ref.id).get().then(doc=> {\n\n          console.log(\"Document data:\", doc.data());\n          old = doc.data()\n          //new_cmts=doc.data().comments\n\n          if( doc.data().comments==null  || doc.data().comments.length==0){\n            new_cmts=[new_comment]\n          }else{\n\n            new_cmts = doc.data().comments.concat(new_comment)\n          }\n          console.log(\"new comment:\",new_cmts)\n\n          this.setState({\n              post_list: this.state.post_list.map(el => (el.id === ref.id ? {...el, comments:new_cmts} : el))\n            });\n\n          fdb.collection('requests').doc(ref.id).update({\n              comments:new_cmts\n            });\n\n    }).catch(function(error) {\n      console.log(\"Error getting document:\", error);\n    });\n\n    return\n  }\n\n  on_Change_content=event=>{\n    const value= event.target.value\n    console.log(value)\n    this.setState({content:value})\n  }\n\n  add_Comment=event=>{\n    const status = this.state.add_cmt == 0? 1:0\n    this.setState({add_cmt:status})\n\n  }\n  handleClick1 = event =>{\n    const value = (this.state.color1 ==1 )? 0:1\n    this.setState({color1: value})\n  }\n  handleClick2=event=>{\n    const value = (this.state.color2 ==1)? 0:1\n    this.setState({ color2: value})\n  }\n  handleClick3=event=>{\n\n    const value = (this.state.color3 ==1)? 0:1\n    this.setState({ color3: value})\n  }\n  handleClick4=event=>{\n\n    const value = (this.state.color4 ==1)? 0:1\n    this.setState({ color4: value})\n  }\n  handleClick5=event=>{\n\n    const value = (this.state.color5==1)? 0:1\n    this.setState({\n      color5: value,\n      color6: 0,\n      color7: 0,\n    })\n  }\n  handleClick6=event=>{\n    const value = (this.state.color6 ==1)? 0:1\n    this.setState({\n      color6: value,\n      color5: 0,\n      color7:0,\n    })\n  }\n  handleClick7=event=>{\n    const value = (this.state.color7 ==1)? 0:1\n    this.setState({\n      color7: value,\n      color5: 0,\n      color6: 0,\n    })\n  }\n  handleClick8=event=>{\n    const value = (this.state.color8 ==1)?0:1\n    this.setState({ color8: value})\n  }\n  handleClick9=event=>{\n    const value = (this.state.color9 ==1)?0:1\n    this.setState({ color9: value})\n  }\n  handleClick11=event=>{\n    const value = (this.state.color11 ==1)?0:1\n    this.setState({ color11: value})\n  }\n  handleClick12=event=>{\n    const value = (this.state.color12 ==1)?0:1\n    this.setState({ color12: value})\n  }\n\n  get_url(email){\n    let url_=\"\"\n    //console.log(storage.ref('images').child(email).getDownloadURL())\n    storage.ref('images').child(email).getDownloadURL().then(url => {\n        console.log(url)\n        url_=url\n        console.log(url)\n        return url\n    }).catch(err => {\n      this.setState({url:\"\"})\n      console.log('Error getting image', err);\n\n    });\n    // console.log(url_)\n    return url_\n  }\n\n  render() {\n    const{classes} = this.props\n    const {post_list, color1,color2,color3,color4,color5,color6,color7,color8,color9,color11,color12} = this.state\n\n    let buffer = []\n    let filtered = []\n\n    if (color1) {\n      const result = post_list.filter(obj =>(obj.taglist.includes(\"HICKS\")));\n      buffer.push.apply(buffer, result)\n    }\n    if (color2) {\n      const result = post_list.filter(obj =>(obj.taglist.includes(\"PMU\")));\n      buffer.push.apply(buffer, result)\n    }\n    if (color3) {\n      const result = post_list.filter(obj =>(obj.taglist.includes(\"LWSN\")));\n      buffer.push.apply(buffer, result)\n    }\n    if (color4) {\n      const result = post_list.filter(obj =>(obj.taglist.includes(\"ECE\")));\n      buffer.push.apply(buffer, result)\n    }\n    if (color5) {\n      const result = post_list.filter(obj =>(obj.taglist.includes(\"LEVEL1\")));\n      buffer.push.apply(buffer, result)\n    }\n    if (color6) {\n      const result = post_list.filter(obj =>(obj.taglist.includes(\"LEVEL2\")));\n      buffer.push.apply(buffer, result)\n    }\n    if (color7) {\n      const result = post_list.filter(obj =>(obj.taglist.includes(\"LEVEL3\")));\n      buffer.push.apply(buffer, result)\n    }\n    if (color8) {\n      const result = post_list.filter(obj =>(obj.taglist.includes(\"Stationery\")));\n      buffer.push.apply(buffer, result)\n    }\n    if (color9) {\n      const result = post_list.filter(obj =>(obj.taglist.includes(\"Commute\")));\n      buffer.push.apply(buffer, result)\n    }\n    if (color11) {\n      const result = post_list.filter(obj =>(obj.taglist.includes(\"Living Essentials\")));\n      buffer.push.apply(buffer, result)\n    }\n    if (color12) {\n      const result = post_list.filter(obj =>(obj.taglist.includes(\"Sports\")));\n      buffer.push.apply(buffer, result)\n    }\n    if (buffer.length == 0) {\n      filtered = post_list\n    }else{\n      filtered = [...new Set(buffer)]\n    }\n    return (\n      <div>\n        <Container>\n          <Grid container spacing={1} alignItems=\"flex-end\">\n            <Grid item>\n              <LocationOnIcon />\n            </Grid>\n            <Grid item>\n              <Chip variant=\"outlined\" size=\"small\" label=\"HICKS\" color = {this.state.color1==0? \"default\":\"primary\" } onClick={this.handleClick1}/>\n            </Grid>\n            <Grid item >\n              <Chip variant=\"outlined\" size=\"small\" label=\"LWSN\" color = {this.state.color2==0? \"default\":\"primary\" } onClick={this.handleClick2} />\n            </Grid>\n            <Grid item >\n              <Chip variant=\"outlined\" size=\"small\" label=\"PMU\" color = {this.state.color3==0? \"default\":\"primary\" } onClick={this.handleClick3} />\n            </Grid >\n            <Grid item>\n              <Chip variant=\"outlined\" size=\"small\" label=\"ECE\" color = {this.state.color4==0? \"default\":\"primary\" } onClick={this.handleClick4}/>\n            </Grid>\n          </Grid>\n          <br />\n          <Grid container spacing={1} alignItems=\"flex-end\">\n            <Grid item>\n              <FlashOnIcon/>\n            </Grid>\n            <Grid item>\n              <Chip variant=\"outlined\" size=\"small\" label=\"Level 1\" color = {this.state.color5==0? \"default\":\"primary\" } onClick={this.handleClick5}/>\n            </Grid>\n            <Grid item>\n              <Chip variant=\"outlined\" size=\"small\" label=\"Level 2\" color = {this.state.color6==0? \"default\":\"primary\" } onClick={this.handleClick6}/>\n            </Grid>\n            <Grid item xs={6}>\n              <Chip variant=\"outlined\" size=\"small\" label=\"Level 3\" color = {this.state.color7==0? \"default\":\"primary\" } onClick={this.handleClick7}/>\n            </Grid>\n          </Grid>\n          <br />\n          <Grid container spacing={1} alignItems=\"flex-end\">\n            <Grid item>\n              <AppsIcon/>\n            </Grid>\n            <Grid item>\n              <Chip variant=\"outlined\" size=\"small\" label=\"Stationery\" color = {this.state.color8==0? \"default\":\"primary\" } onClick={this.handleClick8}/>\n            </Grid>\n            <Grid item>\n              <Chip variant=\"outlined\" size=\"small\" label=\"Commute\" color = {this.state.color9==0? \"default\":\"primary\" } onClick={this.handleClick9}/>\n            </Grid>\n            <Grid item>\n              <Chip variant=\"outlined\" size=\"small\" label=\"Living Essentials\" color = {this.state.color11==0? \"default\":\"primary\" } onClick={this.handleClick11}/>\n            </Grid>\n            <Grid item xs={6}>\n              <Chip variant=\"outlined\" size=\"small\" label=\"Sports\" color = {this.state.color12==0? \"default\":\"primary\" } onClick={this.handleClick12}/>\n            </Grid>\n          </Grid>\n        </Container>\n        <br />\n        <Grid container xs={12} spacing={3}>\n        {filtered.map(post=>\n          <Grid item xs={4}>\n            <Card background={\"#f5edf1\"}>\n                <CardContent>\n                  <Typography variant=\"h4\" component=\"h2\">\n                    {post.title}\n                  </Typography>\n                  <Typography variant= \"h5\" >\n                    {post.content}\n                  </Typography>\n                  <Typography variant=\"h6\" component=\"p\" color=\"textSecondary\">\n                    Borrower: {post.borrower}\n                    <br />\n                  </Typography>\n                  <Typography variant=\"body1\" component=\"p\" color=\"textSecondary\">\n                    Estimated Value: {post.price} $\n                    <br />\n                  </Typography>\n                  <Typography variant=\"h6\" component=\"p\" color=\"textSecondary\">\n                    Guranrtor: {post.guarantor}\n                    <br />\n                  </Typography>\n                  <Box height=\"auto\" overflow=\"auto\">\n\n                    {(post.comment_flag[post.id]) && (<InfiniteScroll items={post.comments}>\n\n                      {item => (\n                        <Box\n                          flex={false}\n                          pad=\"small\"\n                          background={\"#f5edf1\"}\n                        >\n\n                        <Tooltip title = {item.nickname}>\n                          <Avatar size=\"small\" src={this.state.photo_map[item.email]}/>\n                        </Tooltip>\n\n                        <Typography variant=\"h6\" component=\"p\" color=\"textSecondary\">\n                          {item.nickname} : {item.content}\n                          <br />\n                        </Typography>\n                        {(this.props.Email == post.borrower) && (this.props.Email!=item.email)&&\n                           (<Button size=\"small\" onClick={()=>this.onclickLend(post)}>Lend from {item.nickname}</Button>\n                         )}\n\n                         {(this.props.Email==item.email)&&\n                            (<Button size=\"small\" onClick={()=>this.delete_Comment(item.content,item.email,post.id)} >Delete above comment</Button>\n                          )}\n\n                           </Box>\n                      )}\n\n                    </InfiniteScroll>)}\n                  </Box>\n\n                <Grommet theme={grommet}>\n\n                <FormField >\n                  <TextInput onChange={this.on_Change_content} placeholder=\"Add Comments here:\" />\n                </FormField>\n                <Button size=\"small\" onClick={()=>this.on_Submit(post)}>Submit</Button>\n\n                </Grommet>\n                </CardContent>\n                <CardActions>\n\n                  <Button size=\"small\" onClick={()=>this.onClick_Open(post.id)}>Comments</Button>\n                  <Button size=\"small\" onClick={this.add_Comment}>Add Comments</Button>\n                </CardActions>\n            </Card>\n          </Grid>\n        )}\n        </Grid>\n      </div>\n    );\n  }\n}\n\nexport default withStyles(styles, {withTheme: true})(Posts);;\n"]},"metadata":{},"sourceType":"module"}