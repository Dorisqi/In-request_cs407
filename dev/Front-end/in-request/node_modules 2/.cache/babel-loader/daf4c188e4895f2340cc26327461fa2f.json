{"ast":null,"code":"var _jsxFileName = \"/Users/qier/Documents/cs407/In-request_cs407/dev/Front-end/in-request/src/Components/Login_Related/Log_Page.js\";\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport PropTypes from \"prop-types\";\nimport { withStyles } from '@material-ui/core/styles';\nimport { storiesOf } from \"@storybook/react\";\nimport { CircleInformation, FormClose, StatusGood } from \"grommet-icons\";\nimport { Box, Form, CheckBox, RangeInput, Select, FormField, Layer, TextInput, TextArea, Button, MaskedInput, RadioButtonGroup, Grommet, Grid, Stack, Tab, Tabs, Text } from \"grommet\";\nimport { grommet } from \"grommet/themes\";\nimport { Attraction, Car, TreeOption } from \"grommet-icons\";\nimport TextField from '@material-ui/core/TextField';\nimport { Log_in_Box } from \"./Log_in_Box.js\";\nimport { Sign_up_Box } from \"./Sign_up_Box.js\";\nimport { deepMerge } from \"grommet/utils\";\nimport { tryBox } from \"./tryBox.js\";\nimport { css } from \"styled-components\";\nimport \"firebase/auth\";\nimport { auth } from \"../../firebase\";\nimport { fdb } from \"../../firebase\";\nimport { storage } from '../../firebase';\nimport { Redirect } from 'react-router';\nimport { withRouter, BrowserRouter, Switch, Route } from \"react-router-dom\"; //import {Server} from \"./server.js\"\n\nconst customFormFieldTheme = {\n  global: {\n    font: {\n      size: \"16px\"\n    },\n    input: {\n      weight: 400\n    }\n  },\n  formField: {\n    label: {\n      color: \"dark-3\",\n      size: \"large\",\n      margin: \"xsmall\",\n      weight: 600\n    },\n    border: {\n      position: \"outer\",\n      side: \"all\"\n    },\n    disabled: {\n      background: {\n        color: \"light-3\",\n        opacity: true\n      }\n    },\n    content: {\n      pad: \"small\"\n    },\n    error: {\n      background: {\n        color: \"status-critical\",\n        opacity: \"weak\"\n      }\n    },\n    margin: 30\n  },\n  tab: {\n    active: {\n      background: \"dark-1\",\n      color: \"accent-1\"\n    },\n    border: undefined,\n    color: \"white\",\n    hover: {\n      background: \"dark-1\"\n    },\n    margin: undefined,\n    pad: {\n      bottom: undefined,\n      horizontal: \"small\"\n    },\n    extend: ({\n      theme\n    }) => css`\n      border-radius: ${theme.global.control.border.radius};\n      box-shadow: ${theme.global.elevation.light.small};\n    `\n  }\n}; // const RichTabTitle = ({ icon, label }) => (\n//   <Box direction=\"row\" align=\"center\" gap=\"xsmall\" margin=\"xsmall\">\n//     {icon}\n//     <Text size=\"small\">\n//       <strong>{label}</strong>\n//     </Text>\n//   </Box>\n// );\n\nclass Login extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.on_Login = event => {\n      //console.log(this.state.Email)\n      const email = this.state.Email;\n      const ps = this.state.Password;\n      auth.signInWithEmailAndPassword(email, ps).then(error => {\n        // log-in successful.\n        const ref = fdb.collection('users').doc(email);\n        ref.get().then(doc => {\n          if (!doc.exists) {\n            console.log('No such document!');\n          } else {\n            if (auth.currentUser.emailVerified) {\n              ref.update({\n                LoginState: true\n              }).then(() => {\n                console.log('login successful'); // console.log(this.props.history)\n                //get user image\n\n                storage.ref('images').child(this.state.Email).getDownloadURL().then(url => {\n                  //console.log(url);\n                  this.setState({\n                    url: url\n                  });\n\n                  if (url.length != 0) {\n                    this.setState({\n                      hasPhoto: true\n                    });\n                  }\n\n                  this.props.history.push({\n                    pathname: \"/posts\",\n                    state: {\n                      Email: this.state.Email,\n                      Nickname: this.state.Nickname,\n                      auth: this.auth,\n                      url: url,\n                      hasPhoto: false\n                    }\n                  });\n                }); //console.log(this.state.url);\n                // this.props.history.push({\n                //   pathname:\"/posts\",\n                //   state:{\n                //     Email:this.state.Email,\n                //     Nickname:this.state.Nickname,\n                //     auth:this.auth,\n                //     url:this.state.url\n                //\n                //   }\n                // });\n              });\n            } else {\n              alert(\"Email is not verified\");\n            } // console.log(auth.currentUser.emailVerified)\n\n          }\n        }).catch(err => {\n          // An error happened.\n          console.log('Error logging in', err);\n          this.setState(state => ({\n            success_open: true\n          }));\n          console.log(err.message); //this.props.history.push(\"/login\");\n        });\n      });\n    };\n\n    this.on_Signup = event => {\n      //console.log(this.state.Email)\n      const email = this.state.Email;\n      const ps = this.state.Password;\n      const nickname = this.state.Nickname;\n      console.log(\"in signuup\");\n      auth.createUserWithEmailAndPassword(email, ps).then(error => {\n        // log-in successful.\n        const ref = fdb.collection('users').doc(email);\n        ref.set({\n          nickname: nickname,\n          email: email,\n          LoginState: true,\n          photostate: false\n        });\n        var user = auth.currentUser;\n        user.sendEmailVerification().then(function () {// Email sent.\n          //console.log(\"varification\")\n        }).catch(function (error) {\n          // An error happened.\n          console.log(error);\n          alert(console.error());\n        });\n        storage.ref('images').child(this.state.Email).getDownloadURL().then(url => {\n          //console.log(url);\n          this.setState({\n            url: url\n          });\n\n          if (url.length != 0) {\n            this.setState({\n              hasPhoto: true\n            });\n          }\n\n          this.props.history.push({\n            pathname: \"/posts\",\n            state: {\n              Email: this.state.Email,\n              Nickname: this.state.Nickname,\n              auth: this.auth,\n              url: url,\n              hasPhoto: false\n            }\n          });\n        });\n        console.log('signup successful');\n      }).catch(err => {\n        // An error happened.\n        alert(console.err);\n        console.log('Error sign up', err);\n      });\n    };\n\n    this.onActive = event => {\n      //console.log(nextIndex)\n      const value = this.state.index == 0 ? 1 : 0;\n      this.setState({\n        index: value\n      });\n    };\n\n    this.onClose = event => {\n      this.setState({\n        success_open: true\n      });\n    };\n\n    this.state = {\n      Email: \"\",\n      Password: \"\",\n      Nickname: \"\",\n      auth: this.auth,\n      fdb: this.fdb,\n      name: \"\",\n      index: 0,\n      tab_f: 0,\n      success_open: false,\n      url: \"\",\n      hasPhoto: false\n    };\n    this.on_Login = this.on_Login.bind(this);\n    this.on_Signup = this.on_Signup.bind(this);\n    this.update_Pw = this.update_Pw.bind(this);\n    this.update_Email = this.update_Email.bind(this);\n    this.update_Nickname = this.update_Nickname.bind(this);\n    this.onActive = this.onActive.bind(this);\n    this.onClose = this.onClose.bind(this);\n  }\n\n  update_Email(value) {\n    this.setState(state => ({\n      Email: value\n    }));\n  }\n\n  update_Pw(value) {\n    this.setState(state => ({\n      Password: value\n    })); //console.log(value)\n  }\n\n  update_Nickname(value) {\n    this.setState(state => ({\n      Nickname: value\n    })); //console.log(value)\n  }\n\n  render() {\n    return React.createElement(Grommet, {\n      theme: deepMerge(grommet, customFormFieldTheme),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288\n      },\n      __self: this\n    }, React.createElement(Box, {\n      direction: \"column\",\n      pad: \"fill\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 291\n      },\n      __self: this\n    }, React.createElement(Box, {\n      right: true,\n      pad: \"380px\",\n      background: \"#d1bec3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295\n      },\n      __self: this\n    }, React.createElement(Box, {\n      right: true,\n      width: \"90%\",\n      height: \"80%\",\n      pad: \"{{ left: 'large', right: 'large' }}\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296\n      },\n      __self: this\n    }, React.createElement(Tabs, {\n      color: \"#d1bec3\",\n      activeIndex: this.state.index,\n      onActive: this.onActive,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299\n      },\n      __self: this\n    }, React.createElement(Tab, {\n      title: React.createElement(Box, {\n        direction: \"row\",\n        align: \"center\",\n        gap: \"xsmall\",\n        margin: \"xsmall\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 302\n        },\n        __self: this\n      }, React.createElement(Text, {\n        size: \"small\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 303\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 304\n        },\n        __self: this\n      }, \"LOG IN\"))),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300\n      },\n      __self: this\n    }, React.createElement(Log_in_Box, {\n      P_update_pw: this.update_Pw,\n      P_update_email: this.update_Email,\n      P_Submit_func: this.on_Login,\n      auth: this.auth,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309\n      },\n      __self: this\n    }), this.state.success_open && React.createElement(Layer, {\n      position: \"bottom\",\n      modal: false,\n      margin: {\n        vertical: \"medium\",\n        horizontal: \"small\"\n      },\n      onEsc: this.onClose,\n      responsive: false,\n      plain: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315\n      },\n      __self: this\n    }, React.createElement(Box, {\n      align: \"center\",\n      direction: \"row\",\n      gap: \"small\",\n      justify: \"between\",\n      round: \"medium\",\n      elevation: \"medium\",\n      pad: {\n        vertical: \"xsmall\",\n        horizontal: \"small\"\n      },\n      background: \"#bfdbbf\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323\n      },\n      __self: this\n    }, React.createElement(Box, {\n      align: \"center\",\n      direction: \"row\",\n      gap: \"xsmall\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 333\n      },\n      __self: this\n    }, React.createElement(StatusGood, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 334\n      },\n      __self: this\n    }), React.createElement(Text, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 335\n      },\n      __self: this\n    }, \"Login Successful\")), React.createElement(Button, {\n      icon: React.createElement(FormClose, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 337\n        },\n        __self: this\n      }),\n      onClick: this.onClose,\n      plain: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 337\n      },\n      __self: this\n    })))), React.createElement(Tab, {\n      title: React.createElement(Box, {\n        direction: \"row\",\n        align: \"center\",\n        gap: \"xsmall\",\n        margin: \"xsmall\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 344\n        },\n        __self: this\n      }, React.createElement(Text, {\n        size: \"small\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 345\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 346\n        },\n        __self: this\n      }, \"SIGN UP\"))),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342\n      },\n      __self: this\n    }, React.createElement(Sign_up_Box, {\n      P_update_pw: this.update_Pw,\n      P_update_email: this.update_Email,\n      P_Submit_func: this.on_Signup,\n      P_update_nickname: this.update_Nickname,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 351\n      },\n      __self: this\n    })))))));\n  }\n\n}\n\nexport default withRouter(Login);","map":{"version":3,"sources":["/Users/qier/Documents/cs407/In-request_cs407/dev/Front-end/in-request/src/Components/Login_Related/Log_Page.js"],"names":["React","makeStyles","PropTypes","withStyles","storiesOf","CircleInformation","FormClose","StatusGood","Box","Form","CheckBox","RangeInput","Select","FormField","Layer","TextInput","TextArea","Button","MaskedInput","RadioButtonGroup","Grommet","Grid","Stack","Tab","Tabs","Text","grommet","Attraction","Car","TreeOption","TextField","Log_in_Box","Sign_up_Box","deepMerge","tryBox","css","auth","fdb","storage","Redirect","withRouter","BrowserRouter","Switch","Route","customFormFieldTheme","global","font","size","input","weight","formField","label","color","margin","border","position","side","disabled","background","opacity","content","pad","error","tab","active","undefined","hover","bottom","horizontal","extend","theme","control","radius","elevation","light","small","Login","Component","constructor","props","on_Login","event","email","state","Email","ps","Password","signInWithEmailAndPassword","then","ref","collection","doc","get","exists","console","log","currentUser","emailVerified","update","LoginState","child","getDownloadURL","url","setState","length","hasPhoto","history","push","pathname","Nickname","alert","catch","err","success_open","message","on_Signup","nickname","createUserWithEmailAndPassword","set","photostate","user","sendEmailVerification","onActive","value","index","onClose","name","tab_f","bind","update_Pw","update_Email","update_Nickname","render","vertical"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport PropTypes from \"prop-types\";\nimport {withStyles} from '@material-ui/core/styles'\nimport { storiesOf } from \"@storybook/react\";\nimport { CircleInformation,FormClose, StatusGood } from \"grommet-icons\";\nimport { Box,Form,CheckBox,RangeInput,Select,FormField,Layer,TextInput,\n  TextArea,Button,MaskedInput,RadioButtonGroup, Grommet,Grid,Stack, Tab, Tabs, Text } from \"grommet\";\nimport { grommet } from \"grommet/themes\";\nimport { Attraction, Car, TreeOption } from \"grommet-icons\";\nimport TextField from '@material-ui/core/TextField';\nimport {Log_in_Box} from \"./Log_in_Box.js\"\nimport {Sign_up_Box} from \"./Sign_up_Box.js\"\nimport { deepMerge } from \"grommet/utils\";\nimport {tryBox} from \"./tryBox.js\"\nimport { css } from \"styled-components\";\nimport \"firebase/auth\"\nimport {auth} from \"../../firebase\";\nimport {fdb} from \"../../firebase\";\nimport {storage} from '../../firebase';\nimport { Redirect } from 'react-router';\nimport {withRouter,BrowserRouter, Switch, Route } from \"react-router-dom\";\n\n\n//import {Server} from \"./server.js\"\nconst customFormFieldTheme ={\n  global: {\n    font: {\n      size: \"16px\"\n    },\n    input: {\n      weight: 400\n    }\n  },\n  formField: {\n    label: {\n      color: \"dark-3\",\n      size: \"large\",\n      margin: \"xsmall\",\n      weight: 600\n    },\n    border: {\n      position: \"outer\",\n      side: \"all\"\n    },\n    disabled: {\n      background: {\n        color: \"light-3\",\n        opacity: true\n      }\n    },\n\n    content: {\n      pad: \"small\"\n    },\n    error: {\n      background: {\n        color: \"status-critical\",\n        opacity: \"weak\"\n      }\n    },\n    margin: 30\n  },\n  tab: {\n    active: {\n      background: \"dark-1\",\n      color: \"accent-1\"\n    },\n\n    border: undefined,\n    color: \"white\",\n    hover: {\n      background: \"dark-1\"\n    },\n    margin: undefined,\n    pad: {\n      bottom: undefined,\n      horizontal: \"small\"\n    },\n    extend: ({ theme }) => css`\n      border-radius: ${theme.global.control.border.radius};\n      box-shadow: ${theme.global.elevation.light.small};\n    `\n  }\n};\n// const RichTabTitle = ({ icon, label }) => (\n//   <Box direction=\"row\" align=\"center\" gap=\"xsmall\" margin=\"xsmall\">\n//     {icon}\n//     <Text size=\"small\">\n//       <strong>{label}</strong>\n//     </Text>\n//   </Box>\n// );\n\n\n\n\n\nclass Login extends React.Component {\n  constructor(props){\n    super(props)\n    this.state ={\n      Email:\"\",\n      Password:\"\",\n      Nickname:\"\",\n      auth: this.auth,\n      fdb: this.fdb,\n      name:\"\",\n      index:0,\n      tab_f:0,\n      success_open:false,\n      url:\"\",\n      hasPhoto:false\n\n\n\n    }\n\n    this.on_Login=this.on_Login.bind(this)\n    this.on_Signup=this.on_Signup.bind(this)\n    this.update_Pw=this.update_Pw.bind(this)\n    this.update_Email=this.update_Email.bind(this)\n    this.update_Nickname=this.update_Nickname.bind(this)\n    this.onActive=this.onActive.bind(this)\n    this.onClose=this.onClose.bind(this)\n  }\n\n\n  on_Login=event =>{\n    //console.log(this.state.Email)\n    const email = this.state.Email\n    const ps = this.state.Password\n    auth.signInWithEmailAndPassword(email, ps).then(error => {\n  // log-in successful.\n    const ref = fdb.collection('users').doc(email);\n    ref.get().then(doc => {\n      if (!doc.exists) {\n        console.log('No such document!');\n      } else {\n        if(auth.currentUser.emailVerified){\n          ref.update({\n            LoginState: true\n          }).then(() => {\n            console.log('login successful');\n            // console.log(this.props.history)\n            //get user image\n            storage.ref('images').child(this.state.Email).getDownloadURL().then(url => {\n                //console.log(url);\n                this.setState({url:url});\n                if(url.length != 0){\n                  this.setState({\n                    hasPhoto: true\n                  })\n                }\n                this.props.history.push({\n                  pathname:\"/posts\",\n                  state:{\n                    Email:this.state.Email,\n                    Nickname:this.state.Nickname,\n                    auth:this.auth,\n                    url:url,\n                    hasPhoto:false\n\n                  }\n                });\n\n            })\n            //console.log(this.state.url);\n            // this.props.history.push({\n            //   pathname:\"/posts\",\n            //   state:{\n            //     Email:this.state.Email,\n            //     Nickname:this.state.Nickname,\n            //     auth:this.auth,\n            //     url:this.state.url\n            //\n            //   }\n            // });\n          });\n        }else{\n          alert(\"Email is not verified\")\n        }\n        // console.log(auth.currentUser.emailVerified)\n\n      }\n    }).catch(err => {\n      // An error happened.\n      console.log('Error logging in', err);\n      this.setState(state => ({\n        success_open:true\n      }))\n      console.log(err.message)\n      //this.props.history.push(\"/login\");\n    });\n  });\n  }\n\n  on_Signup=event =>{\n    //console.log(this.state.Email)\n    const email = this.state.Email\n    const ps = this.state.Password\n    const nickname=this.state.Nickname\n    console.log(\"in signuup\")\n\n    auth.createUserWithEmailAndPassword(email, ps).then(error => {\n  // log-in successful.\n    const ref = fdb.collection('users').doc(email);\n      ref.set({\n        nickname: nickname, email: email,\n        LoginState: true, photostate: false\n      });\n      var user = auth.currentUser;\n      user.sendEmailVerification().then(function() {\n        // Email sent.\n        //console.log(\"varification\")\n      }).catch(function(error) {\n        // An error happened.\n        console.log(error)\n        alert(console.error())\n      });\n      storage.ref('images').child(this.state.Email).getDownloadURL().then(url => {\n          //console.log(url);\n          this.setState({url:url});\n          if(url.length != 0){\n            this.setState({\n              hasPhoto: true\n            })\n          }\n          this.props.history.push({\n            pathname:\"/posts\",\n            state:{\n              Email:this.state.Email,\n              Nickname:this.state.Nickname,\n              auth:this.auth,\n              url:url,\n              hasPhoto:false\n\n            }\n          });\n\n      })\n      console.log('signup successful');\n    }).catch(err => {\n      // An error happened.\n      alert(console.err)\n      console.log('Error sign up', err);\n    });\n\n\n\n  }\n\n  update_Email(value){\n\n\n      this.setState(state => ({\n        Email:value\n      }))\n\n  }\n  update_Pw(value){\n      this.setState(state => ({\n        Password:value\n      }))\n    //console.log(value)\n  }\n  update_Nickname(value){\n      this.setState(state => ({\n        Nickname:value\n      }))\n    //console.log(value)\n  }\n\n  onActive=event=>{\n\n    //console.log(nextIndex)\n    const value = this.state.index == 0? 1:0\n    this.setState({ index: value })\n  }\nonClose=event=>{\n  this.setState({ success_open: true })\n}\n\n\n\n  render() {\n    return (\n      <Grommet theme={deepMerge(grommet, customFormFieldTheme)}>\n\n\n        <Box\n          direction=\"column\"\n          pad=\"fill\"\n        >\n            <Box right pad=\"380px\" background=\"#d1bec3\">\n              <Box right width=\"90%\" height=\"80%\" pad=\"{{ left: 'large', right: 'large' }}\" >\n\n\n              <Tabs color=\"#d1bec3\" activeIndex={this.state.index} onActive={this.onActive}>\n              <Tab\n                title={\n                  <Box direction=\"row\" align=\"center\" gap=\"xsmall\" margin=\"xsmall\">\n                    <Text size=\"small\">\n                      <strong>LOG IN</strong>\n                    </Text>\n                  </Box>\n                }\n              >\n                <Log_in_Box\n                P_update_pw={this.update_Pw}\n                P_update_email={this.update_Email}\n                P_Submit_func={this.on_Login}\n                auth={this.auth}/>\n                {this.state.success_open && (\n                <Layer\n                  position=\"bottom\"\n                  modal={false}\n                  margin={{ vertical: \"medium\", horizontal: \"small\" }}\n                  onEsc={this.onClose}\n                  responsive={false}\n                  plain\n                >\n                  <Box\n                    align=\"center\"\n                    direction=\"row\"\n                    gap=\"small\"\n                    justify=\"between\"\n                    round=\"medium\"\n                    elevation=\"medium\"\n                    pad={{ vertical: \"xsmall\", horizontal: \"small\" }}\n                    background=\"#bfdbbf\"\n                  >\n                    <Box align=\"center\" direction=\"row\" gap=\"xsmall\">\n                      <StatusGood />\n                      <Text>Login Successful</Text>\n                    </Box>\n                    <Button icon={<FormClose />} onClick={this.onClose} plain />\n                  </Box>\n                </Layer>\n              )}\n              </Tab>\n              <Tab\n                title={\n                  <Box direction=\"row\" align=\"center\" gap=\"xsmall\" margin=\"xsmall\">\n                    <Text size=\"small\">\n                      <strong>SIGN UP</strong>\n                    </Text>\n                  </Box>\n                }\n              >\n                <Sign_up_Box\n                P_update_pw={this.update_Pw}\n                P_update_email={this.update_Email}\n                P_Submit_func={this.on_Signup}\n                P_update_nickname={this.update_Nickname}/>\n              </Tab>\n              </Tabs>\n            </Box>\n          </Box>\n        </Box>\n      </Grommet >\n  );\n  }\n}\n\nexport default withRouter(Login);\n"]},"metadata":{},"sourceType":"module"}