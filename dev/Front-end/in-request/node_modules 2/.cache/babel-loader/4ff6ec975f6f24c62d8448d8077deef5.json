{"ast":null,"code":"\"use strict\";\n/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst path = require(\"path\");\n\nconst createApiCall_1 = require(\"./createApiCall\");\n\nconst descriptor_1 = require(\"./descriptor\");\n\nconst configData = require('./operations_client_config');\n\nexports.SERVICE_ADDRESS = 'longrunning.googleapis.com';\n\nconst version = require('../../package.json').version;\n\nconst DEFAULT_SERVICE_PORT = 443;\nconst CODE_GEN_NAME_VERSION = 'gapic/0.7.1';\nconst PAGE_DESCRIPTORS = {\n  listOperations: new descriptor_1.PageDescriptor('pageToken', 'nextPageToken', 'operations')\n};\n/**\n * The scopes needed to make gRPC calls to all of the methods defined in\n * this service.\n */\n\nexports.ALL_SCOPES = [];\n/**\n * Manages long-running operations with an API service.\n *\n * When an API method normally takes long time to complete, it can be designed\n * to return {@link Operation} to the client, and the client can use this\n * interface to receive the real response asynchronously by polling the\n * operation resource, or pass the operation resource to another API (such as\n * Google Cloud Pub/Sub API) to receive the response.  Any API service that\n * returns long-running operations should implement the `Operations` interface\n * so developers can have a consistent client experience.\n *\n * This will be created through a builder function which can be obtained by the\n * module. See the following example of how to initialize the module and how to\n * access to the builder.\n * @see {@link operationsClient}\n *\n * @class\n */\n\nclass OperationsClient {\n  constructor(gaxGrpc, // tslint:disable-next-line no-any\n  operationsProtos, options) {\n    const opts = Object.assign({\n      servicePath: exports.SERVICE_ADDRESS,\n      port: DEFAULT_SERVICE_PORT,\n      clientConfig: {}\n    }, options);\n    const googleApiClient = ['gl-node/' + process.versions.node];\n\n    if (opts.libName && opts.libVersion) {\n      googleApiClient.push(opts.libName + '/' + opts.libVersion);\n    }\n\n    googleApiClient.push(CODE_GEN_NAME_VERSION, 'gax/' + version);\n\n    if (opts.fallback) {\n      googleApiClient.push('gl-web/' + version);\n    } else {\n      googleApiClient.push('grpc/' + gaxGrpc.grpcVersion);\n    }\n\n    const defaults = gaxGrpc.constructSettings('google.longrunning.Operations', configData, opts.clientConfig || {}, {\n      'x-goog-api-client': googleApiClient.join(' ')\n    });\n    this.auth = gaxGrpc.auth; // Set up a dictionary of \"inner API calls\"; the core implementation\n    // of calling the API is handled in `google-gax`, with this code\n    // merely providing the destination and request information.\n\n    this._innerApiCalls = {}; // Put together the \"service stub\" for\n    // google.longrunning.Operations.\n\n    const operationsStub = gaxGrpc.createStub(opts.fallback ? operationsProtos.lookupService('google.longrunning.Operations') : operationsProtos.google.longrunning.Operations, opts);\n    const operationsStubMethods = ['getOperation', 'listOperations', 'cancelOperation', 'deleteOperation'];\n\n    for (const methodName of operationsStubMethods) {\n      const innerCallPromise = operationsStub.then(stub => (...args) => {\n        return stub[methodName].apply(stub, args);\n      }, err => () => {\n        throw err;\n      });\n      this._innerApiCalls[methodName] = createApiCall_1.createApiCall(innerCallPromise, defaults[methodName], PAGE_DESCRIPTORS[methodName]);\n    }\n  }\n\n  getProjectId(callback) {\n    if (this.auth && 'getProjectId' in this.auth) {\n      return this.auth.getProjectId(callback);\n    }\n\n    if (callback) {\n      callback(new Error('Cannot determine project ID.'));\n    } else {\n      return Promise.reject('Cannot determine project ID.');\n    }\n  } // Service calls\n\n  /**\n   * Gets the latest state of a long-running operation.  Clients can use this\n   * method to poll the operation result at intervals as recommended by the API\n   * service.\n   *\n   * @param {Object} request - The request object that will be sent.\n   * @param {string} request.name - The name of the operation resource.\n   * @param {Object=} options\n   *   Optional parameters. You can override the default settings for this call,\n   *   e.g, timeout, retries, paginations, etc. See [gax.CallOptions]{@link\n   *   https://googleapis.github.io/gax-nodejs/global.html#CallOptions} for the\n   *   details.\n   * @param {function(?Error, ?Object)=} callback\n   *   The function which will be called with the result of the API call.\n   *\n   *   The second parameter to the callback is an object representing\n   * [google.longrunning.Operation]{@link\n   * external:\"google.longrunning.Operation\"}.\n   * @return {Promise} - The promise which resolves to an array.\n   *   The first element of the array is an object representing\n   * [google.longrunning.Operation]{@link\n   * external:\"google.longrunning.Operation\"}. The promise has a method named\n   * \"cancel\" which cancels the ongoing API call.\n   *\n   * @example\n   *\n   * const client = longrunning.operationsClient();\n   * const name = '';\n   * const [response] = await client.getOperation({name});\n   * // doThingsWith(response)\n   */\n\n\n  getOperation(request, options, callback) {\n    if (options instanceof Function && callback === undefined) {\n      return this._innerApiCalls.getOperation(request, {}, options);\n    }\n\n    options = options || {};\n    return this._innerApiCalls.getOperation(request, options, callback);\n  }\n  /**\n   * Lists operations that match the specified filter in the request. If the\n   * server doesn't support this method, it returns `UNIMPLEMENTED`.\n   *\n   * NOTE: the `name` binding below allows API services to override the binding\n   * to use different resource name schemes.\n   *\n   * @param {Object} request - The request object that will be sent.\n   * @param {string} request.name - The name of the operation collection.\n   * @param {string} request.filter - The standard list filter.\n   * @param {number=} request.pageSize\n   *   The maximum number of resources contained in the underlying API\n   *   response. If page streaming is performed per-resource, this\n   *   parameter does not affect the return value. If page streaming is\n   *   performed per-page, this determines the maximum number of\n   *   resources in a page.\n   * @param {Object=} options\n   *   Optional parameters. You can override the default settings for this call,\n   * e.g, timeout, retries, paginations, etc. See [gax.CallOptions]{@link\n   * https://googleapis.github.io/gax-nodejs/global.html#CallOptions} for the\n   * details.\n   * @param {function(?Error, ?Array, ?Object, ?Object)=} callback\n   *   The function which will be called with the result of the API call.\n   *\n   *   The second parameter to the callback is Array of\n   * [google.longrunning.Operation]{@link\n   * external:\"google.longrunning.Operation\"}.\n   *\n   *   When autoPaginate: false is specified through options, it contains the\n   * result in a single response. If the response indicates the next page\n   * exists, the third parameter is set to be used for the next request object.\n   * The fourth parameter keeps the raw response object of an object\n   * representing [google.longrunning.ListOperationsResponse]{@link\n   * external:\"google.longrunning.ListOperationsResponse\"}.\n   * @return {Promise} - The promise which resolves to an array.\n   *   The first element of the array is Array of\n   * [google.longrunning.Operation]{@link\n   * external:\"google.longrunning.Operation\"}.\n   *\n   *   When autoPaginate: false is specified through options, the array has\n   * three elements. The first element is Array of\n   * [google.longrunning.Operation]{@link\n   * external:\"google.longrunning.Operation\"} in a single response. The second\n   * element is the next request object if the response indicates the next page\n   * exists, or null. The third element is an object representing\n   * [google.longrunning.ListOperationsResponse]{@link\n   * external:\"google.longrunning.ListOperationsResponse\"}.\n   *\n   *   The promise has a method named \"cancel\" which cancels the ongoing API\n   * call.\n   *\n   * @example\n   *\n   * const client = longrunning.operationsClient();\n   * const request = {\n   *     name: '',\n   *     filter: ''\n   * };\n   * // Iterate over all elements.\n   * const [resources] = await client.listOperations(request);\n   * for (const resource of resources) {\n   *   console.log(resources);\n   * }\n   *\n   * // Or obtain the paged response.\n   * const options = {autoPaginate: false};\n   * let nextRequest = request;\n   * while(nextRequest) {\n   *   const response = await client.listOperations(nextRequest, options);\n   *   const resources = response[0];\n   *   nextRequest = response[1];\n   *   const rawResponse = response[2];\n   *   for (const resource of resources) {\n   *     // doThingsWith(resource);\n   *   }\n   * };\n   */\n\n\n  listOperations(request, options, callback) {\n    if (options instanceof Function && callback === undefined) {\n      return this._innerApiCalls.listOperations(request, {}, options);\n    }\n\n    options = options || {};\n    return this._innerApiCalls.listOperations(request, options, callback);\n  }\n  /**\n   * Equivalent to {@link listOperations}, but returns a NodeJS Stream object.\n   *\n   * This fetches the paged responses for {@link listOperations} continuously\n   * and invokes the callback registered for 'data' event for each element in\n   * the responses.\n   *\n   * The returned object has 'end' method when no more elements are required.\n   *\n   * autoPaginate option will be ignored.\n   *\n   * @see {@link https://nodejs.org/api/stream.html}\n   *\n   * @param {Object} request - The request object that will be sent.\n   * @param {string} request.name - The name of the operation collection.\n   * @param {string} request.filter - The standard list filter.\n   * @param {number=} request.pageSize -\n   *   The maximum number of resources contained in the underlying API\n   *   response. If page streaming is performed per-resource, this\n   *   parameter does not affect the return value. If page streaming is\n   *   performed per-page, this determines the maximum number of\n   *   resources in a page.\n   * @param {Object=} options\n   *   Optional parameters. You can override the default settings for this call,\n   *   e.g, timeout, retries, paginations, etc. See [gax.CallOptions]{@link\n   *   https://googleapis.github.io/gax-nodejs/global.html#CallOptions} for the\n   *   details.\n   * @return {Stream} - An object stream which emits an object representing [google.longrunning.Operation]{@link external:\"google.longrunning.Operation\"} on 'data' event.\n   *\n   * @example\n   *\n   * const client = longrunning.operationsClient();\n   * const request = {\n   *   name: '',\n   *   filter: ''\n   * };\n   * client.listOperationsStream(request)\n   *   .on('data', element => {\n   *     // doThingsWith(element)\n   *   })\n   *   .on('error', err => {\n   *     console.error(err);\n   *   });\n   */\n\n\n  listOperationsStream(request, options) {\n    return PAGE_DESCRIPTORS.listOperations.createStream(this._innerApiCalls.listOperations, request, options);\n  }\n  /**\n   * Starts asynchronous cancellation on a long-running operation.  The server\n   * makes a best effort to cancel the operation, but success is not\n   * guaranteed.  If the server doesn't support this method, it returns\n   * `google.rpc.Code.UNIMPLEMENTED`.  Clients can use\n   * {@link Operations.GetOperation} or\n   * other methods to check whether the cancellation succeeded or whether the\n   * operation completed despite cancellation. On successful cancellation,\n   * the operation is not deleted; instead, it becomes an operation with\n   * an {@link Operation.error} value with a {@link google.rpc.Status.code} of\n   * 1, corresponding to `Code.CANCELLED`.\n   *\n   * @param {Object} request - The request object that will be sent.\n   * @param {string} request.name - The name of the operation resource to be cancelled.\n   * @param {Object=} options\n   *   Optional parameters. You can override the default settings for this call,\n   * e.g, timeout, retries, paginations, etc. See [gax.CallOptions]{@link\n   * https://googleapis.github.io/gax-nodejs/global.html#CallOptions} for the\n   * details.\n   * @param {function(?Error)=} callback\n   *   The function which will be called with the result of the API call.\n   * @return {Promise} - The promise which resolves when API call finishes.\n   *   The promise has a method named \"cancel\" which cancels the ongoing API\n   * call.\n   *\n   * @example\n   *\n   * const client = longrunning.operationsClient();\n   * await client.cancelOperation({name: ''});\n   */\n\n\n  cancelOperation(request, options, callback) {\n    if (options instanceof Function && callback === undefined) {\n      return this._innerApiCalls.cancelOperation(request, {}, options);\n    }\n\n    options = options || {};\n    return this._innerApiCalls.cancelOperation(request, options, callback);\n  }\n  /**\n   * Deletes a long-running operation. This method indicates that the client is\n   * no longer interested in the operation result. It does not cancel the\n   * operation. If the server doesn't support this method, it returns\n   * `google.rpc.Code.UNIMPLEMENTED`.\n   *\n   * @param {Object} request - The request object that will be sent.\n   * @param {string} request.name - The name of the operation resource to be deleted.\n   * @param {Object=} options\n   *   Optional parameters. You can override the default settings for this call,\n   * e.g, timeout, retries, paginations, etc. See [gax.CallOptions]{@link\n   * https://googleapis.github.io/gax-nodejs/global.html#CallOptions} for the\n   * details.\n   * @param {function(?Error)=} callback\n   *   The function which will be called with the result of the API call.\n   * @return {Promise} - The promise which resolves when API call finishes.\n   *   The promise has a method named \"cancel\" which cancels the ongoing API\n   * call.\n   *\n   * @example\n   *\n   * const client = longrunning.operationsClient();\n   * await client.deleteOperation({name: ''});\n   */\n\n\n  deleteOperation(request, options, callback) {\n    if (options instanceof Function && callback === undefined) {\n      return this._innerApiCalls.deleteOperation(request, {}, options);\n    }\n\n    options = options || {};\n    return this._innerApiCalls.deleteOperation(request, options, callback);\n  }\n\n}\n\nexports.OperationsClient = OperationsClient;\n\nclass OperationsClientBuilder {\n  /**\n   * Builds a new Operations Client\n   * @param gaxGrpc {GrpcClient}\n   */\n  constructor(gaxGrpc) {\n    // tslint:disable-next-line no-any\n    let operationsProtos; // loaded protos have any type\n\n    if (gaxGrpc.fallback) {\n      const protoJson = require('../../protos/operations.json');\n\n      operationsProtos = gaxGrpc.loadProto(protoJson);\n    } else {\n      operationsProtos = gaxGrpc.loadProto(path.join(__dirname, '..', '..', 'protos', 'operations.json'));\n      Object.assign(this, operationsProtos.google.longrunning);\n    }\n    /**\n     * Build a new instance of {@link OperationsClient}.\n     *\n     * @param {Object=} opts - The optional parameters.\n     * @param {String=} opts.servicePath - Domain name of the API remote host.\n     * @param {number=} opts.port - The port on which to connect to the remote host.\n     * @param {grpc.ClientCredentials=} opts.sslCreds - A ClientCredentials for use with an SSL-enabled channel.\n     * @param {Object=} opts.clientConfig - The customized config to build the call settings. See {@link gax.constructSettings} for the format.\n     */\n\n\n    this.operationsClient = opts => {\n      if (gaxGrpc.fallback) {\n        opts.fallback = true;\n      }\n\n      return new OperationsClient(gaxGrpc, operationsProtos, opts);\n    };\n\n    Object.assign(this.operationsClient, OperationsClient);\n  }\n\n}\n\nexports.OperationsClientBuilder = OperationsClientBuilder;","map":{"version":3,"sources":["../../src/operationsClient.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\n/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst path = require(\"path\");\nconst createApiCall_1 = require(\"./createApiCall\");\nconst descriptor_1 = require(\"./descriptor\");\nconst configData = require('./operations_client_config');\nexports.SERVICE_ADDRESS = 'longrunning.googleapis.com';\nconst version = require('../../package.json').version;\nconst DEFAULT_SERVICE_PORT = 443;\nconst CODE_GEN_NAME_VERSION = 'gapic/0.7.1';\nconst PAGE_DESCRIPTORS = {\n    listOperations: new descriptor_1.PageDescriptor('pageToken', 'nextPageToken', 'operations'),\n};\n/**\n * The scopes needed to make gRPC calls to all of the methods defined in\n * this service.\n */\nexports.ALL_SCOPES = [];\n/**\n * Manages long-running operations with an API service.\n *\n * When an API method normally takes long time to complete, it can be designed\n * to return {@link Operation} to the client, and the client can use this\n * interface to receive the real response asynchronously by polling the\n * operation resource, or pass the operation resource to another API (such as\n * Google Cloud Pub/Sub API) to receive the response.  Any API service that\n * returns long-running operations should implement the `Operations` interface\n * so developers can have a consistent client experience.\n *\n * This will be created through a builder function which can be obtained by the\n * module. See the following example of how to initialize the module and how to\n * access to the builder.\n * @see {@link operationsClient}\n *\n * @class\n */\nclass OperationsClient {\n    constructor(gaxGrpc, \n    // tslint:disable-next-line no-any\n    operationsProtos, options) {\n        const opts = Object.assign({\n            servicePath: exports.SERVICE_ADDRESS,\n            port: DEFAULT_SERVICE_PORT,\n            clientConfig: {},\n        }, options);\n        const googleApiClient = ['gl-node/' + process.versions.node];\n        if (opts.libName && opts.libVersion) {\n            googleApiClient.push(opts.libName + '/' + opts.libVersion);\n        }\n        googleApiClient.push(CODE_GEN_NAME_VERSION, 'gax/' + version);\n        if (opts.fallback) {\n            googleApiClient.push('gl-web/' + version);\n        }\n        else {\n            googleApiClient.push('grpc/' + gaxGrpc.grpcVersion);\n        }\n        const defaults = gaxGrpc.constructSettings('google.longrunning.Operations', configData, opts.clientConfig || {}, { 'x-goog-api-client': googleApiClient.join(' ') });\n        this.auth = gaxGrpc.auth;\n        // Set up a dictionary of \"inner API calls\"; the core implementation\n        // of calling the API is handled in `google-gax`, with this code\n        // merely providing the destination and request information.\n        this._innerApiCalls = {};\n        // Put together the \"service stub\" for\n        // google.longrunning.Operations.\n        const operationsStub = gaxGrpc.createStub(opts.fallback\n            ? operationsProtos.lookupService('google.longrunning.Operations')\n            : operationsProtos.google.longrunning.Operations, opts);\n        const operationsStubMethods = [\n            'getOperation',\n            'listOperations',\n            'cancelOperation',\n            'deleteOperation',\n        ];\n        for (const methodName of operationsStubMethods) {\n            const innerCallPromise = operationsStub.then(stub => (...args) => {\n                return stub[methodName].apply(stub, args);\n            }, err => () => {\n                throw err;\n            });\n            this._innerApiCalls[methodName] = createApiCall_1.createApiCall(innerCallPromise, defaults[methodName], PAGE_DESCRIPTORS[methodName]);\n        }\n    }\n    getProjectId(callback) {\n        if (this.auth && 'getProjectId' in this.auth) {\n            return this.auth.getProjectId(callback);\n        }\n        if (callback) {\n            callback(new Error('Cannot determine project ID.'));\n        }\n        else {\n            return Promise.reject('Cannot determine project ID.');\n        }\n    }\n    // Service calls\n    /**\n     * Gets the latest state of a long-running operation.  Clients can use this\n     * method to poll the operation result at intervals as recommended by the API\n     * service.\n     *\n     * @param {Object} request - The request object that will be sent.\n     * @param {string} request.name - The name of the operation resource.\n     * @param {Object=} options\n     *   Optional parameters. You can override the default settings for this call,\n     *   e.g, timeout, retries, paginations, etc. See [gax.CallOptions]{@link\n     *   https://googleapis.github.io/gax-nodejs/global.html#CallOptions} for the\n     *   details.\n     * @param {function(?Error, ?Object)=} callback\n     *   The function which will be called with the result of the API call.\n     *\n     *   The second parameter to the callback is an object representing\n     * [google.longrunning.Operation]{@link\n     * external:\"google.longrunning.Operation\"}.\n     * @return {Promise} - The promise which resolves to an array.\n     *   The first element of the array is an object representing\n     * [google.longrunning.Operation]{@link\n     * external:\"google.longrunning.Operation\"}. The promise has a method named\n     * \"cancel\" which cancels the ongoing API call.\n     *\n     * @example\n     *\n     * const client = longrunning.operationsClient();\n     * const name = '';\n     * const [response] = await client.getOperation({name});\n     * // doThingsWith(response)\n     */\n    getOperation(request, options, callback) {\n        if (options instanceof Function && callback === undefined) {\n            return this._innerApiCalls.getOperation(request, {}, options);\n        }\n        options = options || {};\n        return this._innerApiCalls.getOperation(request, options, callback);\n    }\n    /**\n     * Lists operations that match the specified filter in the request. If the\n     * server doesn't support this method, it returns `UNIMPLEMENTED`.\n     *\n     * NOTE: the `name` binding below allows API services to override the binding\n     * to use different resource name schemes.\n     *\n     * @param {Object} request - The request object that will be sent.\n     * @param {string} request.name - The name of the operation collection.\n     * @param {string} request.filter - The standard list filter.\n     * @param {number=} request.pageSize\n     *   The maximum number of resources contained in the underlying API\n     *   response. If page streaming is performed per-resource, this\n     *   parameter does not affect the return value. If page streaming is\n     *   performed per-page, this determines the maximum number of\n     *   resources in a page.\n     * @param {Object=} options\n     *   Optional parameters. You can override the default settings for this call,\n     * e.g, timeout, retries, paginations, etc. See [gax.CallOptions]{@link\n     * https://googleapis.github.io/gax-nodejs/global.html#CallOptions} for the\n     * details.\n     * @param {function(?Error, ?Array, ?Object, ?Object)=} callback\n     *   The function which will be called with the result of the API call.\n     *\n     *   The second parameter to the callback is Array of\n     * [google.longrunning.Operation]{@link\n     * external:\"google.longrunning.Operation\"}.\n     *\n     *   When autoPaginate: false is specified through options, it contains the\n     * result in a single response. If the response indicates the next page\n     * exists, the third parameter is set to be used for the next request object.\n     * The fourth parameter keeps the raw response object of an object\n     * representing [google.longrunning.ListOperationsResponse]{@link\n     * external:\"google.longrunning.ListOperationsResponse\"}.\n     * @return {Promise} - The promise which resolves to an array.\n     *   The first element of the array is Array of\n     * [google.longrunning.Operation]{@link\n     * external:\"google.longrunning.Operation\"}.\n     *\n     *   When autoPaginate: false is specified through options, the array has\n     * three elements. The first element is Array of\n     * [google.longrunning.Operation]{@link\n     * external:\"google.longrunning.Operation\"} in a single response. The second\n     * element is the next request object if the response indicates the next page\n     * exists, or null. The third element is an object representing\n     * [google.longrunning.ListOperationsResponse]{@link\n     * external:\"google.longrunning.ListOperationsResponse\"}.\n     *\n     *   The promise has a method named \"cancel\" which cancels the ongoing API\n     * call.\n     *\n     * @example\n     *\n     * const client = longrunning.operationsClient();\n     * const request = {\n     *     name: '',\n     *     filter: ''\n     * };\n     * // Iterate over all elements.\n     * const [resources] = await client.listOperations(request);\n     * for (const resource of resources) {\n     *   console.log(resources);\n     * }\n     *\n     * // Or obtain the paged response.\n     * const options = {autoPaginate: false};\n     * let nextRequest = request;\n     * while(nextRequest) {\n     *   const response = await client.listOperations(nextRequest, options);\n     *   const resources = response[0];\n     *   nextRequest = response[1];\n     *   const rawResponse = response[2];\n     *   for (const resource of resources) {\n     *     // doThingsWith(resource);\n     *   }\n     * };\n     */\n    listOperations(request, options, callback) {\n        if (options instanceof Function && callback === undefined) {\n            return this._innerApiCalls.listOperations(request, {}, options);\n        }\n        options = options || {};\n        return this._innerApiCalls.listOperations(request, options, callback);\n    }\n    /**\n     * Equivalent to {@link listOperations}, but returns a NodeJS Stream object.\n     *\n     * This fetches the paged responses for {@link listOperations} continuously\n     * and invokes the callback registered for 'data' event for each element in\n     * the responses.\n     *\n     * The returned object has 'end' method when no more elements are required.\n     *\n     * autoPaginate option will be ignored.\n     *\n     * @see {@link https://nodejs.org/api/stream.html}\n     *\n     * @param {Object} request - The request object that will be sent.\n     * @param {string} request.name - The name of the operation collection.\n     * @param {string} request.filter - The standard list filter.\n     * @param {number=} request.pageSize -\n     *   The maximum number of resources contained in the underlying API\n     *   response. If page streaming is performed per-resource, this\n     *   parameter does not affect the return value. If page streaming is\n     *   performed per-page, this determines the maximum number of\n     *   resources in a page.\n     * @param {Object=} options\n     *   Optional parameters. You can override the default settings for this call,\n     *   e.g, timeout, retries, paginations, etc. See [gax.CallOptions]{@link\n     *   https://googleapis.github.io/gax-nodejs/global.html#CallOptions} for the\n     *   details.\n     * @return {Stream} - An object stream which emits an object representing [google.longrunning.Operation]{@link external:\"google.longrunning.Operation\"} on 'data' event.\n     *\n     * @example\n     *\n     * const client = longrunning.operationsClient();\n     * const request = {\n     *   name: '',\n     *   filter: ''\n     * };\n     * client.listOperationsStream(request)\n     *   .on('data', element => {\n     *     // doThingsWith(element)\n     *   })\n     *   .on('error', err => {\n     *     console.error(err);\n     *   });\n     */\n    listOperationsStream(request, options) {\n        return PAGE_DESCRIPTORS.listOperations.createStream(this._innerApiCalls.listOperations, request, options);\n    }\n    /**\n     * Starts asynchronous cancellation on a long-running operation.  The server\n     * makes a best effort to cancel the operation, but success is not\n     * guaranteed.  If the server doesn't support this method, it returns\n     * `google.rpc.Code.UNIMPLEMENTED`.  Clients can use\n     * {@link Operations.GetOperation} or\n     * other methods to check whether the cancellation succeeded or whether the\n     * operation completed despite cancellation. On successful cancellation,\n     * the operation is not deleted; instead, it becomes an operation with\n     * an {@link Operation.error} value with a {@link google.rpc.Status.code} of\n     * 1, corresponding to `Code.CANCELLED`.\n     *\n     * @param {Object} request - The request object that will be sent.\n     * @param {string} request.name - The name of the operation resource to be cancelled.\n     * @param {Object=} options\n     *   Optional parameters. You can override the default settings for this call,\n     * e.g, timeout, retries, paginations, etc. See [gax.CallOptions]{@link\n     * https://googleapis.github.io/gax-nodejs/global.html#CallOptions} for the\n     * details.\n     * @param {function(?Error)=} callback\n     *   The function which will be called with the result of the API call.\n     * @return {Promise} - The promise which resolves when API call finishes.\n     *   The promise has a method named \"cancel\" which cancels the ongoing API\n     * call.\n     *\n     * @example\n     *\n     * const client = longrunning.operationsClient();\n     * await client.cancelOperation({name: ''});\n     */\n    cancelOperation(request, options, callback) {\n        if (options instanceof Function && callback === undefined) {\n            return this._innerApiCalls.cancelOperation(request, {}, options);\n        }\n        options = options || {};\n        return this._innerApiCalls.cancelOperation(request, options, callback);\n    }\n    /**\n     * Deletes a long-running operation. This method indicates that the client is\n     * no longer interested in the operation result. It does not cancel the\n     * operation. If the server doesn't support this method, it returns\n     * `google.rpc.Code.UNIMPLEMENTED`.\n     *\n     * @param {Object} request - The request object that will be sent.\n     * @param {string} request.name - The name of the operation resource to be deleted.\n     * @param {Object=} options\n     *   Optional parameters. You can override the default settings for this call,\n     * e.g, timeout, retries, paginations, etc. See [gax.CallOptions]{@link\n     * https://googleapis.github.io/gax-nodejs/global.html#CallOptions} for the\n     * details.\n     * @param {function(?Error)=} callback\n     *   The function which will be called with the result of the API call.\n     * @return {Promise} - The promise which resolves when API call finishes.\n     *   The promise has a method named \"cancel\" which cancels the ongoing API\n     * call.\n     *\n     * @example\n     *\n     * const client = longrunning.operationsClient();\n     * await client.deleteOperation({name: ''});\n     */\n    deleteOperation(request, options, callback) {\n        if (options instanceof Function && callback === undefined) {\n            return this._innerApiCalls.deleteOperation(request, {}, options);\n        }\n        options = options || {};\n        return this._innerApiCalls.deleteOperation(request, options, callback);\n    }\n}\nexports.OperationsClient = OperationsClient;\nclass OperationsClientBuilder {\n    /**\n     * Builds a new Operations Client\n     * @param gaxGrpc {GrpcClient}\n     */\n    constructor(gaxGrpc) {\n        // tslint:disable-next-line no-any\n        let operationsProtos; // loaded protos have any type\n        if (gaxGrpc.fallback) {\n            const protoJson = require('../../protos/operations.json');\n            operationsProtos = gaxGrpc.loadProto(protoJson);\n        }\n        else {\n            operationsProtos = gaxGrpc.loadProto(path.join(__dirname, '..', '..', 'protos', 'operations.json'));\n            Object.assign(this, operationsProtos.google.longrunning);\n        }\n        /**\n         * Build a new instance of {@link OperationsClient}.\n         *\n         * @param {Object=} opts - The optional parameters.\n         * @param {String=} opts.servicePath - Domain name of the API remote host.\n         * @param {number=} opts.port - The port on which to connect to the remote host.\n         * @param {grpc.ClientCredentials=} opts.sslCreds - A ClientCredentials for use with an SSL-enabled channel.\n         * @param {Object=} opts.clientConfig - The customized config to build the call settings. See {@link gax.constructSettings} for the format.\n         */\n        this.operationsClient = opts => {\n            if (gaxGrpc.fallback) {\n                opts.fallback = true;\n            }\n            return new OperationsClient(gaxGrpc, operationsProtos, opts);\n        };\n        Object.assign(this.operationsClient, OperationsClient);\n    }\n}\nexports.OperationsClientBuilder = OperationsClientBuilder;\n//# sourceMappingURL=operationsClient.js.map"]},"metadata":{},"sourceType":"script"}